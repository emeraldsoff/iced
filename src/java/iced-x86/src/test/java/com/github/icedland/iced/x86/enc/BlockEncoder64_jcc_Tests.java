// SPDX-License-Identifier: MIT
// Copyright (C) 2018-present iced project and contributors

package com.github.icedland.iced.x86.enc;

import org.junit.jupiter.api.*;
import com.github.icedland.iced.x86.dec.DecoderOptions;

final class BlockEncoder64_jcc_Tests extends BlockEncoderTests {
	static final int bitness = 64;
	static final long origRip = 0x8000L;
	static final long newRip = 0x8000000000000000L;

	@Test
	void jcc_short_fwd() {
		byte[] originalData = new byte[] {
			/*0000*/ 0x70, 0x3E,// jo short 0000000000000040h
			/*0002*/ (byte)0xB0, 0x00,// mov al,0
			/*0004*/ 0x71, 0x3A,// jno short 0000000000000040h
			/*0006*/ (byte)0xB0, 0x01,// mov al,1
			/*0008*/ 0x72, 0x36,// jb short 0000000000000040h
			/*000A*/ (byte)0xB0, 0x02,// mov al,2
			/*000C*/ 0x73, 0x32,// jae short 0000000000000040h
			/*000E*/ (byte)0xB0, 0x03,// mov al,3
			/*0010*/ 0x74, 0x2E,// je short 0000000000000040h
			/*0012*/ (byte)0xB0, 0x04,// mov al,4
			/*0014*/ 0x75, 0x2A,// jne short 0000000000000040h
			/*0016*/ (byte)0xB0, 0x05,// mov al,5
			/*0018*/ 0x76, 0x26,// jbe short 0000000000000040h
			/*001A*/ (byte)0xB0, 0x06,// mov al,6
			/*001C*/ 0x77, 0x22,// ja short 0000000000000040h
			/*001E*/ (byte)0xB0, 0x07,// mov al,7
			/*0020*/ 0x78, 0x1E,// js short 0000000000000040h
			/*0022*/ (byte)0xB0, 0x08,// mov al,8
			/*0024*/ 0x79, 0x1A,// jns short 0000000000000040h
			/*0026*/ (byte)0xB0, 0x09,// mov al,9
			/*0028*/ 0x7A, 0x16,// jp short 0000000000000040h
			/*002A*/ (byte)0xB0, 0x0A,// mov al,0Ah
			/*002C*/ 0x7B, 0x12,// jnp short 0000000000000040h
			/*002E*/ (byte)0xB0, 0x0B,// mov al,0Bh
			/*0030*/ 0x7C, 0x0E,// jl short 0000000000000040h
			/*0032*/ (byte)0xB0, 0x0C,// mov al,0Ch
			/*0034*/ 0x7D, 0x0A,// jge short 0000000000000040h
			/*0036*/ (byte)0xB0, 0x0D,// mov al,0Dh
			/*0038*/ 0x7E, 0x06,// jle short 0000000000000040h
			/*003A*/ (byte)0xB0, 0x0E,// mov al,0Eh
			/*003C*/ 0x7F, 0x02,// jg short 0000000000000040h
			/*003E*/ (byte)0xB0, 0x0F,// mov al,0Fh
			/*0040*/ (byte)0xB0, 0x10,// mov al,10h
		};
		byte[] newData = new byte[] {
			/*0000*/ 0x70, 0x3E,// jo short 0000000000000040h
			/*0002*/ (byte)0xB0, 0x00,// mov al,0
			/*0004*/ 0x71, 0x3A,// jno short 0000000000000040h
			/*0006*/ (byte)0xB0, 0x01,// mov al,1
			/*0008*/ 0x72, 0x36,// jb short 0000000000000040h
			/*000A*/ (byte)0xB0, 0x02,// mov al,2
			/*000C*/ 0x73, 0x32,// jae short 0000000000000040h
			/*000E*/ (byte)0xB0, 0x03,// mov al,3
			/*0010*/ 0x74, 0x2E,// je short 0000000000000040h
			/*0012*/ (byte)0xB0, 0x04,// mov al,4
			/*0014*/ 0x75, 0x2A,// jne short 0000000000000040h
			/*0016*/ (byte)0xB0, 0x05,// mov al,5
			/*0018*/ 0x76, 0x26,// jbe short 0000000000000040h
			/*001A*/ (byte)0xB0, 0x06,// mov al,6
			/*001C*/ 0x77, 0x22,// ja short 0000000000000040h
			/*001E*/ (byte)0xB0, 0x07,// mov al,7
			/*0020*/ 0x78, 0x1E,// js short 0000000000000040h
			/*0022*/ (byte)0xB0, 0x08,// mov al,8
			/*0024*/ 0x79, 0x1A,// jns short 0000000000000040h
			/*0026*/ (byte)0xB0, 0x09,// mov al,9
			/*0028*/ 0x7A, 0x16,// jp short 0000000000000040h
			/*002A*/ (byte)0xB0, 0x0A,// mov al,0Ah
			/*002C*/ 0x7B, 0x12,// jnp short 0000000000000040h
			/*002E*/ (byte)0xB0, 0x0B,// mov al,0Bh
			/*0030*/ 0x7C, 0x0E,// jl short 0000000000000040h
			/*0032*/ (byte)0xB0, 0x0C,// mov al,0Ch
			/*0034*/ 0x7D, 0x0A,// jge short 0000000000000040h
			/*0036*/ (byte)0xB0, 0x0D,// mov al,0Dh
			/*0038*/ 0x7E, 0x06,// jle short 0000000000000040h
			/*003A*/ (byte)0xB0, 0x0E,// mov al,0Eh
			/*003C*/ 0x7F, 0x02,// jg short 0000000000000040h
			/*003E*/ (byte)0xB0, 0x0F,// mov al,0Fh
			/*0040*/ (byte)0xB0, 0x10,// mov al,10h
		};
		int[] expectedInstructionOffsets = new int[] {
			0x0000,
			0x0002,
			0x0004,
			0x0006,
			0x0008,
			0x000A,
			0x000C,
			0x000E,
			0x0010,
			0x0012,
			0x0014,
			0x0016,
			0x0018,
			0x001A,
			0x001C,
			0x001E,
			0x0020,
			0x0022,
			0x0024,
			0x0026,
			0x0028,
			0x002A,
			0x002C,
			0x002E,
			0x0030,
			0x0032,
			0x0034,
			0x0036,
			0x0038,
			0x003A,
			0x003C,
			0x003E,
			0x0040,
		};
		RelocInfo[] expectedRelocInfos = new RelocInfo[0];
		final int options = BlockEncoderOptions.NONE;
		encodeBase(bitness, origRip, originalData, newRip, newData, options, DECODER_OPTIONS, expectedInstructionOffsets, expectedRelocInfos);
	}

	@Test
	void jcc_short_fwd_os() {
		byte[] originalData = new byte[] {
			/*0000*/ 0x66, 0x70, 0x4D,// jo short 0050h
			/*0003*/ (byte)0xB0, 0x00,// mov al,0
			/*0005*/ 0x66, 0x71, 0x48,// jno short 0050h
			/*0008*/ (byte)0xB0, 0x01,// mov al,1
			/*000A*/ 0x66, 0x72, 0x43,// jb short 0050h
			/*000D*/ (byte)0xB0, 0x02,// mov al,2
			/*000F*/ 0x66, 0x73, 0x3E,// jae short 0050h
			/*0012*/ (byte)0xB0, 0x03,// mov al,3
			/*0014*/ 0x66, 0x74, 0x39,// je short 0050h
			/*0017*/ (byte)0xB0, 0x04,// mov al,4
			/*0019*/ 0x66, 0x75, 0x34,// jne short 0050h
			/*001C*/ (byte)0xB0, 0x05,// mov al,5
			/*001E*/ 0x66, 0x76, 0x2F,// jbe short 0050h
			/*0021*/ (byte)0xB0, 0x06,// mov al,6
			/*0023*/ 0x66, 0x77, 0x2A,// ja short 0050h
			/*0026*/ (byte)0xB0, 0x07,// mov al,7
			/*0028*/ 0x66, 0x78, 0x25,// js short 0050h
			/*002B*/ (byte)0xB0, 0x08,// mov al,8
			/*002D*/ 0x66, 0x79, 0x20,// jns short 0050h
			/*0030*/ (byte)0xB0, 0x09,// mov al,9
			/*0032*/ 0x66, 0x7A, 0x1B,// jp short 0050h
			/*0035*/ (byte)0xB0, 0x0A,// mov al,0Ah
			/*0037*/ 0x66, 0x7B, 0x16,// jnp short 0050h
			/*003A*/ (byte)0xB0, 0x0B,// mov al,0Bh
			/*003C*/ 0x66, 0x7C, 0x11,// jl short 0050h
			/*003F*/ (byte)0xB0, 0x0C,// mov al,0Ch
			/*0041*/ 0x66, 0x7D, 0x0C,// jge short 0050h
			/*0044*/ (byte)0xB0, 0x0D,// mov al,0Dh
			/*0046*/ 0x66, 0x7E, 0x07,// jle short 0050h
			/*0049*/ (byte)0xB0, 0x0E,// mov al,0Eh
			/*004B*/ 0x66, 0x7F, 0x02,// jg short 0050h
			/*004E*/ (byte)0xB0, 0x0F,// mov al,0Fh
			/*0050*/ (byte)0xB0, 0x10,// mov al,10h
		};
		byte[] newData = new byte[] {
			/*0000*/ 0x66, 0x70, 0x4D,// jo short 0050h
			/*0003*/ (byte)0xB0, 0x00,// mov al,0
			/*0005*/ 0x66, 0x71, 0x48,// jno short 0050h
			/*0008*/ (byte)0xB0, 0x01,// mov al,1
			/*000A*/ 0x66, 0x72, 0x43,// jb short 0050h
			/*000D*/ (byte)0xB0, 0x02,// mov al,2
			/*000F*/ 0x66, 0x73, 0x3E,// jae short 0050h
			/*0012*/ (byte)0xB0, 0x03,// mov al,3
			/*0014*/ 0x66, 0x74, 0x39,// je short 0050h
			/*0017*/ (byte)0xB0, 0x04,// mov al,4
			/*0019*/ 0x66, 0x75, 0x34,// jne short 0050h
			/*001C*/ (byte)0xB0, 0x05,// mov al,5
			/*001E*/ 0x66, 0x76, 0x2F,// jbe short 0050h
			/*0021*/ (byte)0xB0, 0x06,// mov al,6
			/*0023*/ 0x66, 0x77, 0x2A,// ja short 0050h
			/*0026*/ (byte)0xB0, 0x07,// mov al,7
			/*0028*/ 0x66, 0x78, 0x25,// js short 0050h
			/*002B*/ (byte)0xB0, 0x08,// mov al,8
			/*002D*/ 0x66, 0x79, 0x20,// jns short 0050h
			/*0030*/ (byte)0xB0, 0x09,// mov al,9
			/*0032*/ 0x66, 0x7A, 0x1B,// jp short 0050h
			/*0035*/ (byte)0xB0, 0x0A,// mov al,0Ah
			/*0037*/ 0x66, 0x7B, 0x16,// jnp short 0050h
			/*003A*/ (byte)0xB0, 0x0B,// mov al,0Bh
			/*003C*/ 0x66, 0x7C, 0x11,// jl short 0050h
			/*003F*/ (byte)0xB0, 0x0C,// mov al,0Ch
			/*0041*/ 0x66, 0x7D, 0x0C,// jge short 0050h
			/*0044*/ (byte)0xB0, 0x0D,// mov al,0Dh
			/*0046*/ 0x66, 0x7E, 0x07,// jle short 0050h
			/*0049*/ (byte)0xB0, 0x0E,// mov al,0Eh
			/*004B*/ 0x66, 0x7F, 0x02,// jg short 0050h
			/*004E*/ (byte)0xB0, 0x0F,// mov al,0Fh
			/*0050*/ (byte)0xB0, 0x10,// mov al,10h
		};
		int[] expectedInstructionOffsets = new int[] {
			0x0000,
			0x0003,
			0x0005,
			0x0008,
			0x000A,
			0x000D,
			0x000F,
			0x0012,
			0x0014,
			0x0017,
			0x0019,
			0x001C,
			0x001E,
			0x0021,
			0x0023,
			0x0026,
			0x0028,
			0x002B,
			0x002D,
			0x0030,
			0x0032,
			0x0035,
			0x0037,
			0x003A,
			0x003C,
			0x003F,
			0x0041,
			0x0044,
			0x0046,
			0x0049,
			0x004B,
			0x004E,
			0x0050,
		};
		RelocInfo[] expectedRelocInfos = new RelocInfo[0];
		final int options = BlockEncoderOptions.NONE;
		encodeBase(bitness, origRip, originalData, newRip, newData, options, DECODER_OPTIONS | DecoderOptions.AMD, expectedInstructionOffsets, expectedRelocInfos);
	}

	@Test
	void jcc_short_bwd() {
		byte[] originalData = new byte[] {
			/*0000*/ (byte)0xB0, 0x10,// mov al,10h
			/*0002*/ 0x70, (byte)0xFC,// jo short 0
			/*0004*/ (byte)0xB0, 0x00,// mov al,0
			/*0006*/ 0x71, (byte)0xF8,// jno short 0
			/*0008*/ (byte)0xB0, 0x01,// mov al,1
			/*000A*/ 0x72, (byte)0xF4,// jb short 0
			/*000C*/ (byte)0xB0, 0x02,// mov al,2
			/*000E*/ 0x73, (byte)0xF0,// jae short 0
			/*0010*/ (byte)0xB0, 0x03,// mov al,3
			/*0012*/ 0x74, (byte)0xEC,// je short 0
			/*0014*/ (byte)0xB0, 0x04,// mov al,4
			/*0016*/ 0x75, (byte)0xE8,// jne short 0
			/*0018*/ (byte)0xB0, 0x05,// mov al,5
			/*001A*/ 0x76, (byte)0xE4,// jbe short 0
			/*001C*/ (byte)0xB0, 0x06,// mov al,6
			/*001E*/ 0x77, (byte)0xE0,// ja short 0
			/*0020*/ (byte)0xB0, 0x07,// mov al,7
			/*0022*/ 0x78, (byte)0xDC,// js short 0
			/*0024*/ (byte)0xB0, 0x08,// mov al,8
			/*0026*/ 0x79, (byte)0xD8,// jns short 0
			/*0028*/ (byte)0xB0, 0x09,// mov al,9
			/*002A*/ 0x7A, (byte)0xD4,// jp short 0
			/*002C*/ (byte)0xB0, 0x0A,// mov al,0Ah
			/*002E*/ 0x7B, (byte)0xD0,// jnp short 0
			/*0030*/ (byte)0xB0, 0x0B,// mov al,0Bh
			/*0032*/ 0x7C, (byte)0xCC,// jl short 0
			/*0034*/ (byte)0xB0, 0x0C,// mov al,0Ch
			/*0036*/ 0x7D, (byte)0xC8,// jge short 0
			/*0038*/ (byte)0xB0, 0x0D,// mov al,0Dh
			/*003A*/ 0x7E, (byte)0xC4,// jle short 0
			/*003C*/ (byte)0xB0, 0x0E,// mov al,0Eh
			/*003E*/ 0x7F, (byte)0xC0,// jg short 0
			/*0040*/ (byte)0xB0, 0x0F,// mov al,0Fh
		};
		byte[] newData = new byte[] {
			/*0000*/ (byte)0xB0, 0x10,// mov al,10h
			/*0002*/ 0x70, (byte)0xFC,// jo short 0
			/*0004*/ (byte)0xB0, 0x00,// mov al,0
			/*0006*/ 0x71, (byte)0xF8,// jno short 0
			/*0008*/ (byte)0xB0, 0x01,// mov al,1
			/*000A*/ 0x72, (byte)0xF4,// jb short 0
			/*000C*/ (byte)0xB0, 0x02,// mov al,2
			/*000E*/ 0x73, (byte)0xF0,// jae short 0
			/*0010*/ (byte)0xB0, 0x03,// mov al,3
			/*0012*/ 0x74, (byte)0xEC,// je short 0
			/*0014*/ (byte)0xB0, 0x04,// mov al,4
			/*0016*/ 0x75, (byte)0xE8,// jne short 0
			/*0018*/ (byte)0xB0, 0x05,// mov al,5
			/*001A*/ 0x76, (byte)0xE4,// jbe short 0
			/*001C*/ (byte)0xB0, 0x06,// mov al,6
			/*001E*/ 0x77, (byte)0xE0,// ja short 0
			/*0020*/ (byte)0xB0, 0x07,// mov al,7
			/*0022*/ 0x78, (byte)0xDC,// js short 0
			/*0024*/ (byte)0xB0, 0x08,// mov al,8
			/*0026*/ 0x79, (byte)0xD8,// jns short 0
			/*0028*/ (byte)0xB0, 0x09,// mov al,9
			/*002A*/ 0x7A, (byte)0xD4,// jp short 0
			/*002C*/ (byte)0xB0, 0x0A,// mov al,0Ah
			/*002E*/ 0x7B, (byte)0xD0,// jnp short 0
			/*0030*/ (byte)0xB0, 0x0B,// mov al,0Bh
			/*0032*/ 0x7C, (byte)0xCC,// jl short 0
			/*0034*/ (byte)0xB0, 0x0C,// mov al,0Ch
			/*0036*/ 0x7D, (byte)0xC8,// jge short 0
			/*0038*/ (byte)0xB0, 0x0D,// mov al,0Dh
			/*003A*/ 0x7E, (byte)0xC4,// jle short 0
			/*003C*/ (byte)0xB0, 0x0E,// mov al,0Eh
			/*003E*/ 0x7F, (byte)0xC0,// jg short 0
			/*0040*/ (byte)0xB0, 0x0F,// mov al,0Fh
		};
		int[] expectedInstructionOffsets = new int[] {
			0x0000,
			0x0002,
			0x0004,
			0x0006,
			0x0008,
			0x000A,
			0x000C,
			0x000E,
			0x0010,
			0x0012,
			0x0014,
			0x0016,
			0x0018,
			0x001A,
			0x001C,
			0x001E,
			0x0020,
			0x0022,
			0x0024,
			0x0026,
			0x0028,
			0x002A,
			0x002C,
			0x002E,
			0x0030,
			0x0032,
			0x0034,
			0x0036,
			0x0038,
			0x003A,
			0x003C,
			0x003E,
			0x0040,
		};
		RelocInfo[] expectedRelocInfos = new RelocInfo[0];
		final int options = BlockEncoderOptions.NONE;
		encodeBase(bitness, origRip, originalData, newRip, newData, options, DECODER_OPTIONS, expectedInstructionOffsets, expectedRelocInfos);
	}

	@Test
	void jcc_short_bwd_os() {
		byte[] originalData = new byte[] {
			/*0000*/ (byte)0xB0, 0x10,// mov al,10h
			/*0002*/ 0x66, 0x70, (byte)0xFB,// jo short 0
			/*0005*/ (byte)0xB0, 0x00,// mov al,0
			/*0007*/ 0x66, 0x71, (byte)0xF6,// jno short 0
			/*000A*/ (byte)0xB0, 0x01,// mov al,1
			/*000C*/ 0x66, 0x72, (byte)0xF1,// jb short 0
			/*000F*/ (byte)0xB0, 0x02,// mov al,2
			/*0011*/ 0x66, 0x73, (byte)0xEC,// jae short 0
			/*0014*/ (byte)0xB0, 0x03,// mov al,3
			/*0016*/ 0x66, 0x74, (byte)0xE7,// je short 0
			/*0019*/ (byte)0xB0, 0x04,// mov al,4
			/*001B*/ 0x66, 0x75, (byte)0xE2,// jne short 0
			/*001E*/ (byte)0xB0, 0x05,// mov al,5
			/*0020*/ 0x66, 0x76, (byte)0xDD,// jbe short 0
			/*0023*/ (byte)0xB0, 0x06,// mov al,6
			/*0025*/ 0x66, 0x77, (byte)0xD8,// ja short 0
			/*0028*/ (byte)0xB0, 0x07,// mov al,7
			/*002A*/ 0x66, 0x78, (byte)0xD3,// js short 0
			/*002D*/ (byte)0xB0, 0x08,// mov al,8
			/*002F*/ 0x66, 0x79, (byte)0xCE,// jns short 0
			/*0032*/ (byte)0xB0, 0x09,// mov al,9
			/*0034*/ 0x66, 0x7A, (byte)0xC9,// jp short 0
			/*0037*/ (byte)0xB0, 0x0A,// mov al,0Ah
			/*0039*/ 0x66, 0x7B, (byte)0xC4,// jnp short 0
			/*003C*/ (byte)0xB0, 0x0B,// mov al,0Bh
			/*003E*/ 0x66, 0x7C, (byte)0xBF,// jl short 0
			/*0041*/ (byte)0xB0, 0x0C,// mov al,0Ch
			/*0043*/ 0x66, 0x7D, (byte)0xBA,// jge short 0
			/*0046*/ (byte)0xB0, 0x0D,// mov al,0Dh
			/*0048*/ 0x66, 0x7E, (byte)0xB5,// jle short 0
			/*004B*/ (byte)0xB0, 0x0E,// mov al,0Eh
			/*004D*/ 0x66, 0x7F, (byte)0xB0,// jg short 0
			/*0050*/ (byte)0xB0, 0x0F,// mov al,0Fh
		};
		byte[] newData = new byte[] {
			/*0000*/ (byte)0xB0, 0x10,// mov al,10h
			/*0002*/ 0x66, 0x70, (byte)0xFB,// jo short 0
			/*0005*/ (byte)0xB0, 0x00,// mov al,0
			/*0007*/ 0x66, 0x71, (byte)0xF6,// jno short 0
			/*000A*/ (byte)0xB0, 0x01,// mov al,1
			/*000C*/ 0x66, 0x72, (byte)0xF1,// jb short 0
			/*000F*/ (byte)0xB0, 0x02,// mov al,2
			/*0011*/ 0x66, 0x73, (byte)0xEC,// jae short 0
			/*0014*/ (byte)0xB0, 0x03,// mov al,3
			/*0016*/ 0x66, 0x74, (byte)0xE7,// je short 0
			/*0019*/ (byte)0xB0, 0x04,// mov al,4
			/*001B*/ 0x66, 0x75, (byte)0xE2,// jne short 0
			/*001E*/ (byte)0xB0, 0x05,// mov al,5
			/*0020*/ 0x66, 0x76, (byte)0xDD,// jbe short 0
			/*0023*/ (byte)0xB0, 0x06,// mov al,6
			/*0025*/ 0x66, 0x77, (byte)0xD8,// ja short 0
			/*0028*/ (byte)0xB0, 0x07,// mov al,7
			/*002A*/ 0x66, 0x78, (byte)0xD3,// js short 0
			/*002D*/ (byte)0xB0, 0x08,// mov al,8
			/*002F*/ 0x66, 0x79, (byte)0xCE,// jns short 0
			/*0032*/ (byte)0xB0, 0x09,// mov al,9
			/*0034*/ 0x66, 0x7A, (byte)0xC9,// jp short 0
			/*0037*/ (byte)0xB0, 0x0A,// mov al,0Ah
			/*0039*/ 0x66, 0x7B, (byte)0xC4,// jnp short 0
			/*003C*/ (byte)0xB0, 0x0B,// mov al,0Bh
			/*003E*/ 0x66, 0x7C, (byte)0xBF,// jl short 0
			/*0041*/ (byte)0xB0, 0x0C,// mov al,0Ch
			/*0043*/ 0x66, 0x7D, (byte)0xBA,// jge short 0
			/*0046*/ (byte)0xB0, 0x0D,// mov al,0Dh
			/*0048*/ 0x66, 0x7E, (byte)0xB5,// jle short 0
			/*004B*/ (byte)0xB0, 0x0E,// mov al,0Eh
			/*004D*/ 0x66, 0x7F, (byte)0xB0,// jg short 0
			/*0050*/ (byte)0xB0, 0x0F,// mov al,0Fh
		};
		int[] expectedInstructionOffsets = new int[] {
			0x0000,
			0x0002,
			0x0005,
			0x0007,
			0x000A,
			0x000C,
			0x000F,
			0x0011,
			0x0014,
			0x0016,
			0x0019,
			0x001B,
			0x001E,
			0x0020,
			0x0023,
			0x0025,
			0x0028,
			0x002A,
			0x002D,
			0x002F,
			0x0032,
			0x0034,
			0x0037,
			0x0039,
			0x003C,
			0x003E,
			0x0041,
			0x0043,
			0x0046,
			0x0048,
			0x004B,
			0x004D,
			0x0050,
		};
		RelocInfo[] expectedRelocInfos = new RelocInfo[0];
		final int options = BlockEncoderOptions.NONE;
		encodeBase(bitness, origRip, originalData, newRip, newData, options, DECODER_OPTIONS | DecoderOptions.AMD, expectedInstructionOffsets, expectedRelocInfos);
	}

	@Test
	void jcc_short_other_short() {
		byte[] originalData = new byte[] {
			/*0000*/ 0x70, 0x3E,// jo short 0000000000000040h
			/*0002*/ (byte)0xB0, 0x00,// mov al,0
			/*0004*/ 0x71, 0x3A,// jno short 0000000000000040h
			/*0006*/ (byte)0xB0, 0x01,// mov al,1
			/*0008*/ 0x72, 0x36,// jb short 0000000000000040h
			/*000A*/ (byte)0xB0, 0x02,// mov al,2
			/*000C*/ 0x73, 0x32,// jae short 0000000000000040h
			/*000E*/ (byte)0xB0, 0x03,// mov al,3
			/*0010*/ 0x74, 0x2E,// je short 0000000000000040h
			/*0012*/ (byte)0xB0, 0x04,// mov al,4
			/*0014*/ 0x75, 0x2A,// jne short 0000000000000040h
			/*0016*/ (byte)0xB0, 0x05,// mov al,5
			/*0018*/ 0x76, 0x26,// jbe short 0000000000000040h
			/*001A*/ (byte)0xB0, 0x06,// mov al,6
			/*001C*/ 0x77, 0x22,// ja short 0000000000000040h
			/*001E*/ (byte)0xB0, 0x07,// mov al,7
			/*0020*/ 0x78, 0x1E,// js short 0000000000000040h
			/*0022*/ (byte)0xB0, 0x08,// mov al,8
			/*0024*/ 0x79, 0x1A,// jns short 0000000000000040h
			/*0026*/ (byte)0xB0, 0x09,// mov al,9
			/*0028*/ 0x7A, 0x16,// jp short 0000000000000040h
			/*002A*/ (byte)0xB0, 0x0A,// mov al,0Ah
			/*002C*/ 0x7B, 0x12,// jnp short 0000000000000040h
			/*002E*/ (byte)0xB0, 0x0B,// mov al,0Bh
			/*0030*/ 0x7C, 0x0E,// jl short 0000000000000040h
			/*0032*/ (byte)0xB0, 0x0C,// mov al,0Ch
			/*0034*/ 0x7D, 0x0A,// jge short 0000000000000040h
			/*0036*/ (byte)0xB0, 0x0D,// mov al,0Dh
			/*0038*/ 0x7E, 0x06,// jle short 0000000000000040h
			/*003A*/ (byte)0xB0, 0x0E,// mov al,0Eh
			/*003C*/ 0x7F, 0x02,// jg short 0000000000000040h
			/*003E*/ (byte)0xB0, 0x0F,// mov al,0Fh
		};
		byte[] newData = new byte[] {
			/*0000*/ 0x70, 0x3F,// jo short 0000000000000041h
			/*0002*/ (byte)0xB0, 0x00,// mov al,0
			/*0004*/ 0x71, 0x3B,// jno short 0000000000000041h
			/*0006*/ (byte)0xB0, 0x01,// mov al,1
			/*0008*/ 0x72, 0x37,// jb short 0000000000000041h
			/*000A*/ (byte)0xB0, 0x02,// mov al,2
			/*000C*/ 0x73, 0x33,// jae short 0000000000000041h
			/*000E*/ (byte)0xB0, 0x03,// mov al,3
			/*0010*/ 0x74, 0x2F,// je short 0000000000000041h
			/*0012*/ (byte)0xB0, 0x04,// mov al,4
			/*0014*/ 0x75, 0x2B,// jne short 0000000000000041h
			/*0016*/ (byte)0xB0, 0x05,// mov al,5
			/*0018*/ 0x76, 0x27,// jbe short 0000000000000041h
			/*001A*/ (byte)0xB0, 0x06,// mov al,6
			/*001C*/ 0x77, 0x23,// ja short 0000000000000041h
			/*001E*/ (byte)0xB0, 0x07,// mov al,7
			/*0020*/ 0x78, 0x1F,// js short 0000000000000041h
			/*0022*/ (byte)0xB0, 0x08,// mov al,8
			/*0024*/ 0x79, 0x1B,// jns short 0000000000000041h
			/*0026*/ (byte)0xB0, 0x09,// mov al,9
			/*0028*/ 0x7A, 0x17,// jp short 0000000000000041h
			/*002A*/ (byte)0xB0, 0x0A,// mov al,0Ah
			/*002C*/ 0x7B, 0x13,// jnp short 0000000000000041h
			/*002E*/ (byte)0xB0, 0x0B,// mov al,0Bh
			/*0030*/ 0x7C, 0x0F,// jl short 0000000000000041h
			/*0032*/ (byte)0xB0, 0x0C,// mov al,0Ch
			/*0034*/ 0x7D, 0x0B,// jge short 0000000000000041h
			/*0036*/ (byte)0xB0, 0x0D,// mov al,0Dh
			/*0038*/ 0x7E, 0x07,// jle short 0000000000000041h
			/*003A*/ (byte)0xB0, 0x0E,// mov al,0Eh
			/*003C*/ 0x7F, 0x03,// jg short 0000000000000041h
			/*003E*/ (byte)0xB0, 0x0F,// mov al,0Fh
		};
		int[] expectedInstructionOffsets = new int[] {
			0x0000,
			0x0002,
			0x0004,
			0x0006,
			0x0008,
			0x000A,
			0x000C,
			0x000E,
			0x0010,
			0x0012,
			0x0014,
			0x0016,
			0x0018,
			0x001A,
			0x001C,
			0x001E,
			0x0020,
			0x0022,
			0x0024,
			0x0026,
			0x0028,
			0x002A,
			0x002C,
			0x002E,
			0x0030,
			0x0032,
			0x0034,
			0x0036,
			0x0038,
			0x003A,
			0x003C,
			0x003E,
		};
		RelocInfo[] expectedRelocInfos = new RelocInfo[0];
		final int options = BlockEncoderOptions.NONE;
		encodeBase(bitness, origRip, originalData, origRip - 1, newData, options, DECODER_OPTIONS, expectedInstructionOffsets, expectedRelocInfos);
	}

	@Test
	void jcc_short_other_near() {
		byte[] originalData = new byte[] {
			/*0000*/ 0x70, 0x3E,// jo short 0000000000000040h
			/*0002*/ (byte)0xB0, 0x00,// mov al,0
			/*0004*/ 0x71, 0x3A,// jno short 0000000000000040h
			/*0006*/ (byte)0xB0, 0x01,// mov al,1
			/*0008*/ 0x72, 0x36,// jb short 0000000000000040h
			/*000A*/ (byte)0xB0, 0x02,// mov al,2
			/*000C*/ 0x73, 0x32,// jae short 0000000000000040h
			/*000E*/ (byte)0xB0, 0x03,// mov al,3
			/*0010*/ 0x74, 0x2E,// je short 0000000000000040h
			/*0012*/ (byte)0xB0, 0x04,// mov al,4
			/*0014*/ 0x75, 0x2A,// jne short 0000000000000040h
			/*0016*/ (byte)0xB0, 0x05,// mov al,5
			/*0018*/ 0x76, 0x26,// jbe short 0000000000000040h
			/*001A*/ (byte)0xB0, 0x06,// mov al,6
			/*001C*/ 0x77, 0x22,// ja short 0000000000000040h
			/*001E*/ (byte)0xB0, 0x07,// mov al,7
			/*0020*/ 0x78, 0x1E,// js short 0000000000000040h
			/*0022*/ (byte)0xB0, 0x08,// mov al,8
			/*0024*/ 0x79, 0x1A,// jns short 0000000000000040h
			/*0026*/ (byte)0xB0, 0x09,// mov al,9
			/*0028*/ 0x7A, 0x16,// jp short 0000000000000040h
			/*002A*/ (byte)0xB0, 0x0A,// mov al,0Ah
			/*002C*/ 0x7B, 0x12,// jnp short 0000000000000040h
			/*002E*/ (byte)0xB0, 0x0B,// mov al,0Bh
			/*0030*/ 0x7C, 0x0E,// jl short 0000000000000040h
			/*0032*/ (byte)0xB0, 0x0C,// mov al,0Ch
			/*0034*/ 0x7D, 0x0A,// jge short 0000000000000040h
			/*0036*/ (byte)0xB0, 0x0D,// mov al,0Dh
			/*0038*/ 0x7E, 0x06,// jle short 0000000000000040h
			/*003A*/ (byte)0xB0, 0x0E,// mov al,0Eh
			/*003C*/ 0x7F, 0x02,// jg short 0000000000000040h
			/*003E*/ (byte)0xB0, 0x0F,// mov al,0Fh
		};
		byte[] newData = new byte[] {
			/*0000*/ 0x0F, (byte)0x80, 0x3A, (byte)0xF0, (byte)0xFF, (byte)0xFF,// jo near ptr 0FFFFFFFFFFFFF040h
			/*0006*/ (byte)0xB0, 0x00,// mov al,0
			/*0008*/ 0x0F, (byte)0x81, 0x32, (byte)0xF0, (byte)0xFF, (byte)0xFF,// jno near ptr 0FFFFFFFFFFFFF040h
			/*000E*/ (byte)0xB0, 0x01,// mov al,1
			/*0010*/ 0x0F, (byte)0x82, 0x2A, (byte)0xF0, (byte)0xFF, (byte)0xFF,// jb near ptr 0FFFFFFFFFFFFF040h
			/*0016*/ (byte)0xB0, 0x02,// mov al,2
			/*0018*/ 0x0F, (byte)0x83, 0x22, (byte)0xF0, (byte)0xFF, (byte)0xFF,// jae near ptr 0FFFFFFFFFFFFF040h
			/*001E*/ (byte)0xB0, 0x03,// mov al,3
			/*0020*/ 0x0F, (byte)0x84, 0x1A, (byte)0xF0, (byte)0xFF, (byte)0xFF,// je near ptr 0FFFFFFFFFFFFF040h
			/*0026*/ (byte)0xB0, 0x04,// mov al,4
			/*0028*/ 0x0F, (byte)0x85, 0x12, (byte)0xF0, (byte)0xFF, (byte)0xFF,// jne near ptr 0FFFFFFFFFFFFF040h
			/*002E*/ (byte)0xB0, 0x05,// mov al,5
			/*0030*/ 0x0F, (byte)0x86, 0x0A, (byte)0xF0, (byte)0xFF, (byte)0xFF,// jbe near ptr 0FFFFFFFFFFFFF040h
			/*0036*/ (byte)0xB0, 0x06,// mov al,6
			/*0038*/ 0x0F, (byte)0x87, 0x02, (byte)0xF0, (byte)0xFF, (byte)0xFF,// ja near ptr 0FFFFFFFFFFFFF040h
			/*003E*/ (byte)0xB0, 0x07,// mov al,7
			/*0040*/ 0x0F, (byte)0x88, (byte)0xFA, (byte)0xEF, (byte)0xFF, (byte)0xFF,// js near ptr 0FFFFFFFFFFFFF040h
			/*0046*/ (byte)0xB0, 0x08,// mov al,8
			/*0048*/ 0x0F, (byte)0x89, (byte)0xF2, (byte)0xEF, (byte)0xFF, (byte)0xFF,// jns near ptr 0FFFFFFFFFFFFF040h
			/*004E*/ (byte)0xB0, 0x09,// mov al,9
			/*0050*/ 0x0F, (byte)0x8A, (byte)0xEA, (byte)0xEF, (byte)0xFF, (byte)0xFF,// jp near ptr 0FFFFFFFFFFFFF040h
			/*0056*/ (byte)0xB0, 0x0A,// mov al,0Ah
			/*0058*/ 0x0F, (byte)0x8B, (byte)0xE2, (byte)0xEF, (byte)0xFF, (byte)0xFF,// jnp near ptr 0FFFFFFFFFFFFF040h
			/*005E*/ (byte)0xB0, 0x0B,// mov al,0Bh
			/*0060*/ 0x0F, (byte)0x8C, (byte)0xDA, (byte)0xEF, (byte)0xFF, (byte)0xFF,// jl near ptr 0FFFFFFFFFFFFF040h
			/*0066*/ (byte)0xB0, 0x0C,// mov al,0Ch
			/*0068*/ 0x0F, (byte)0x8D, (byte)0xD2, (byte)0xEF, (byte)0xFF, (byte)0xFF,// jge near ptr 0FFFFFFFFFFFFF040h
			/*006E*/ (byte)0xB0, 0x0D,// mov al,0Dh
			/*0070*/ 0x0F, (byte)0x8E, (byte)0xCA, (byte)0xEF, (byte)0xFF, (byte)0xFF,// jle near ptr 0FFFFFFFFFFFFF040h
			/*0076*/ (byte)0xB0, 0x0E,// mov al,0Eh
			/*0078*/ 0x0F, (byte)0x8F, (byte)0xC2, (byte)0xEF, (byte)0xFF, (byte)0xFF,// jg near ptr 0FFFFFFFFFFFFF040h
			/*007E*/ (byte)0xB0, 0x0F,// mov al,0Fh
		};
		int[] expectedInstructionOffsets = new int[] {
			0x0000,
			0x0006,
			0x0008,
			0x000E,
			0x0010,
			0x0016,
			0x0018,
			0x001E,
			0x0020,
			0x0026,
			0x0028,
			0x002E,
			0x0030,
			0x0036,
			0x0038,
			0x003E,
			0x0040,
			0x0046,
			0x0048,
			0x004E,
			0x0050,
			0x0056,
			0x0058,
			0x005E,
			0x0060,
			0x0066,
			0x0068,
			0x006E,
			0x0070,
			0x0076,
			0x0078,
			0x007E,
		};
		RelocInfo[] expectedRelocInfos = new RelocInfo[0];
		final int options = BlockEncoderOptions.NONE;
		encodeBase(bitness, origRip, originalData, origRip + 0x1000, newData, options, DECODER_OPTIONS, expectedInstructionOffsets, expectedRelocInfos);
	}

	@Test
	void jcc_short_other_short_os() {
		byte[] originalData = new byte[] {
			/*0000*/ 0x66, 0x70, 0x4D,// jo short 8050h
			/*0003*/ (byte)0xB0, 0x00,// mov al,0
			/*0005*/ 0x66, 0x71, 0x49,// jno short 8051h
			/*0008*/ (byte)0xB0, 0x01,// mov al,1
			/*000A*/ 0x66, 0x72, 0x45,// jb short 8052h
			/*000D*/ (byte)0xB0, 0x02,// mov al,2
			/*000F*/ 0x66, 0x73, 0x41,// jae short 8053h
			/*0012*/ (byte)0xB0, 0x03,// mov al,3
			/*0014*/ 0x66, 0x74, 0x3D,// je short 8054h
			/*0017*/ (byte)0xB0, 0x04,// mov al,4
			/*0019*/ 0x66, 0x75, 0x39,// jne short 8055h
			/*001C*/ (byte)0xB0, 0x05,// mov al,5
			/*001E*/ 0x66, 0x76, 0x35,// jbe short 8056h
			/*0021*/ (byte)0xB0, 0x06,// mov al,6
			/*0023*/ 0x66, 0x77, 0x31,// ja short 8057h
			/*0026*/ (byte)0xB0, 0x07,// mov al,7
			/*0028*/ 0x66, 0x78, 0x2D,// js short 8058h
			/*002B*/ (byte)0xB0, 0x08,// mov al,8
			/*002D*/ 0x66, 0x79, 0x29,// jns short 8059h
			/*0030*/ (byte)0xB0, 0x09,// mov al,9
			/*0032*/ 0x66, 0x7A, 0x25,// jp short 805Ah
			/*0035*/ (byte)0xB0, 0x0A,// mov al,0Ah
			/*0037*/ 0x66, 0x7B, 0x21,// jnp short 805Bh
			/*003A*/ (byte)0xB0, 0x0B,// mov al,0Bh
			/*003C*/ 0x66, 0x7C, 0x1D,// jl short 805Ch
			/*003F*/ (byte)0xB0, 0x0C,// mov al,0Ch
			/*0041*/ 0x66, 0x7D, 0x19,// jge short 805Dh
			/*0044*/ (byte)0xB0, 0x0D,// mov al,0Dh
			/*0046*/ 0x66, 0x7E, 0x15,// jle short 805Eh
			/*0049*/ (byte)0xB0, 0x0E,// mov al,0Eh
			/*004B*/ 0x66, 0x7F, 0x11,// jg short 805Fh
			/*004E*/ (byte)0xB0, 0x0F,// mov al,0Fh
		};
		byte[] newData = new byte[] {
			/*0000*/ 0x66, 0x70, 0x4E,// jo short 8050h
			/*0003*/ (byte)0xB0, 0x00,// mov al,0
			/*0005*/ 0x66, 0x71, 0x4A,// jno short 8051h
			/*0008*/ (byte)0xB0, 0x01,// mov al,1
			/*000A*/ 0x66, 0x72, 0x46,// jb short 8052h
			/*000D*/ (byte)0xB0, 0x02,// mov al,2
			/*000F*/ 0x66, 0x73, 0x42,// jae short 8053h
			/*0012*/ (byte)0xB0, 0x03,// mov al,3
			/*0014*/ 0x66, 0x74, 0x3E,// je short 8054h
			/*0017*/ (byte)0xB0, 0x04,// mov al,4
			/*0019*/ 0x66, 0x75, 0x3A,// jne short 8055h
			/*001C*/ (byte)0xB0, 0x05,// mov al,5
			/*001E*/ 0x66, 0x76, 0x36,// jbe short 8056h
			/*0021*/ (byte)0xB0, 0x06,// mov al,6
			/*0023*/ 0x66, 0x77, 0x32,// ja short 8057h
			/*0026*/ (byte)0xB0, 0x07,// mov al,7
			/*0028*/ 0x66, 0x78, 0x2E,// js short 8058h
			/*002B*/ (byte)0xB0, 0x08,// mov al,8
			/*002D*/ 0x66, 0x79, 0x2A,// jns short 8059h
			/*0030*/ (byte)0xB0, 0x09,// mov al,9
			/*0032*/ 0x66, 0x7A, 0x26,// jp short 805Ah
			/*0035*/ (byte)0xB0, 0x0A,// mov al,0Ah
			/*0037*/ 0x66, 0x7B, 0x22,// jnp short 805Bh
			/*003A*/ (byte)0xB0, 0x0B,// mov al,0Bh
			/*003C*/ 0x66, 0x7C, 0x1E,// jl short 805Ch
			/*003F*/ (byte)0xB0, 0x0C,// mov al,0Ch
			/*0041*/ 0x66, 0x7D, 0x1A,// jge short 805Dh
			/*0044*/ (byte)0xB0, 0x0D,// mov al,0Dh
			/*0046*/ 0x66, 0x7E, 0x16,// jle short 805Eh
			/*0049*/ (byte)0xB0, 0x0E,// mov al,0Eh
			/*004B*/ 0x66, 0x7F, 0x12,// jg short 805Fh
			/*004E*/ (byte)0xB0, 0x0F,// mov al,0Fh
		};
		int[] expectedInstructionOffsets = new int[] {
			0x0000,
			0x0003,
			0x0005,
			0x0008,
			0x000A,
			0x000D,
			0x000F,
			0x0012,
			0x0014,
			0x0017,
			0x0019,
			0x001C,
			0x001E,
			0x0021,
			0x0023,
			0x0026,
			0x0028,
			0x002B,
			0x002D,
			0x0030,
			0x0032,
			0x0035,
			0x0037,
			0x003A,
			0x003C,
			0x003F,
			0x0041,
			0x0044,
			0x0046,
			0x0049,
			0x004B,
			0x004E,
		};
		RelocInfo[] expectedRelocInfos = new RelocInfo[0];
		final int options = BlockEncoderOptions.NONE;
		encodeBase(bitness, origRip, originalData, origRip - 1, newData, options, DECODER_OPTIONS | DecoderOptions.AMD, expectedInstructionOffsets, expectedRelocInfos);
	}

	@Test
	void jcc_short_other_near_os() {
		byte[] originalData = new byte[] {
			/*0000*/ 0x66, 0x70, 0x4D,// jo short 8050h
			/*0003*/ (byte)0xB0, 0x00,// mov al,0
			/*0005*/ 0x66, 0x71, 0x49,// jno short 8051h
			/*0008*/ (byte)0xB0, 0x01,// mov al,1
			/*000A*/ 0x66, 0x72, 0x45,// jb short 8052h
			/*000D*/ (byte)0xB0, 0x02,// mov al,2
			/*000F*/ 0x66, 0x73, 0x41,// jae short 8053h
			/*0012*/ (byte)0xB0, 0x03,// mov al,3
			/*0014*/ 0x66, 0x74, 0x3D,// je short 8054h
			/*0017*/ (byte)0xB0, 0x04,// mov al,4
			/*0019*/ 0x66, 0x75, 0x39,// jne short 8055h
			/*001C*/ (byte)0xB0, 0x05,// mov al,5
			/*001E*/ 0x66, 0x76, 0x35,// jbe short 8056h
			/*0021*/ (byte)0xB0, 0x06,// mov al,6
			/*0023*/ 0x66, 0x77, 0x31,// ja short 8057h
			/*0026*/ (byte)0xB0, 0x07,// mov al,7
			/*0028*/ 0x66, 0x78, 0x2D,// js short 8058h
			/*002B*/ (byte)0xB0, 0x08,// mov al,8
			/*002D*/ 0x66, 0x79, 0x29,// jns short 8059h
			/*0030*/ (byte)0xB0, 0x09,// mov al,9
			/*0032*/ 0x66, 0x7A, 0x25,// jp short 805Ah
			/*0035*/ (byte)0xB0, 0x0A,// mov al,0Ah
			/*0037*/ 0x66, 0x7B, 0x21,// jnp short 805Bh
			/*003A*/ (byte)0xB0, 0x0B,// mov al,0Bh
			/*003C*/ 0x66, 0x7C, 0x1D,// jl short 805Ch
			/*003F*/ (byte)0xB0, 0x0C,// mov al,0Ch
			/*0041*/ 0x66, 0x7D, 0x19,// jge short 805Dh
			/*0044*/ (byte)0xB0, 0x0D,// mov al,0Dh
			/*0046*/ 0x66, 0x7E, 0x15,// jle short 805Eh
			/*0049*/ (byte)0xB0, 0x0E,// mov al,0Eh
			/*004B*/ 0x66, 0x7F, 0x11,// jg short 805Fh
			/*004E*/ (byte)0xB0, 0x0F,// mov al,0Fh
		};
		byte[] newData = new byte[] {
			/*0000*/ 0x66, 0x0F, (byte)0x80, 0x4B, (byte)0xF0,// jo near ptr 8050h
			/*0005*/ (byte)0xB0, 0x00,// mov al,0
			/*0007*/ 0x66, 0x0F, (byte)0x81, 0x45, (byte)0xF0,// jno near ptr 8051h
			/*000C*/ (byte)0xB0, 0x01,// mov al,1
			/*000E*/ 0x66, 0x0F, (byte)0x82, 0x3F, (byte)0xF0,// jb near ptr 8052h
			/*0013*/ (byte)0xB0, 0x02,// mov al,2
			/*0015*/ 0x66, 0x0F, (byte)0x83, 0x39, (byte)0xF0,// jae near ptr 8053h
			/*001A*/ (byte)0xB0, 0x03,// mov al,3
			/*001C*/ 0x66, 0x0F, (byte)0x84, 0x33, (byte)0xF0,// je near ptr 8054h
			/*0021*/ (byte)0xB0, 0x04,// mov al,4
			/*0023*/ 0x66, 0x0F, (byte)0x85, 0x2D, (byte)0xF0,// jne near ptr 8055h
			/*0028*/ (byte)0xB0, 0x05,// mov al,5
			/*002A*/ 0x66, 0x0F, (byte)0x86, 0x27, (byte)0xF0,// jbe near ptr 8056h
			/*002F*/ (byte)0xB0, 0x06,// mov al,6
			/*0031*/ 0x66, 0x0F, (byte)0x87, 0x21, (byte)0xF0,// ja near ptr 8057h
			/*0036*/ (byte)0xB0, 0x07,// mov al,7
			/*0038*/ 0x66, 0x0F, (byte)0x88, 0x1B, (byte)0xF0,// js near ptr 8058h
			/*003D*/ (byte)0xB0, 0x08,// mov al,8
			/*003F*/ 0x66, 0x0F, (byte)0x89, 0x15, (byte)0xF0,// jns near ptr 8059h
			/*0044*/ (byte)0xB0, 0x09,// mov al,9
			/*0046*/ 0x66, 0x0F, (byte)0x8A, 0x0F, (byte)0xF0,// jp near ptr 805Ah
			/*004B*/ (byte)0xB0, 0x0A,// mov al,0Ah
			/*004D*/ 0x66, 0x0F, (byte)0x8B, 0x09, (byte)0xF0,// jnp near ptr 805Bh
			/*0052*/ (byte)0xB0, 0x0B,// mov al,0Bh
			/*0054*/ 0x66, 0x0F, (byte)0x8C, 0x03, (byte)0xF0,// jl near ptr 805Ch
			/*0059*/ (byte)0xB0, 0x0C,// mov al,0Ch
			/*005B*/ 0x66, 0x0F, (byte)0x8D, (byte)0xFD, (byte)0xEF,// jge near ptr 805Dh
			/*0060*/ (byte)0xB0, 0x0D,// mov al,0Dh
			/*0062*/ 0x66, 0x0F, (byte)0x8E, (byte)0xF7, (byte)0xEF,// jle near ptr 805Eh
			/*0067*/ (byte)0xB0, 0x0E,// mov al,0Eh
			/*0069*/ 0x66, 0x0F, (byte)0x8F, (byte)0xF1, (byte)0xEF,// jg near ptr 805Fh
			/*006E*/ (byte)0xB0, 0x0F,// mov al,0Fh
		};
		int[] expectedInstructionOffsets = new int[] {
			0x0000,
			0x0005,
			0x0007,
			0x000C,
			0x000E,
			0x0013,
			0x0015,
			0x001A,
			0x001C,
			0x0021,
			0x0023,
			0x0028,
			0x002A,
			0x002F,
			0x0031,
			0x0036,
			0x0038,
			0x003D,
			0x003F,
			0x0044,
			0x0046,
			0x004B,
			0x004D,
			0x0052,
			0x0054,
			0x0059,
			0x005B,
			0x0060,
			0x0062,
			0x0067,
			0x0069,
			0x006E,
		};
		RelocInfo[] expectedRelocInfos = new RelocInfo[0];
		final int options = BlockEncoderOptions.NONE;
		encodeBase(bitness, origRip, originalData, origRip + 0x1000, newData, options, DECODER_OPTIONS | DecoderOptions.AMD, expectedInstructionOffsets, expectedRelocInfos);
	}

	@Test
	void jcc_short_other_long() {
		byte[] originalData = new byte[] {
			/*0000*/ 0x70, 0x3F,// jo short 123456789ABCDE41h
			/*0002*/ (byte)0xB0, 0x00,// mov al,0
			/*0004*/ 0x71, 0x3C,// jno short 123456789ABCDE42h
			/*0006*/ (byte)0xB0, 0x01,// mov al,1
			/*0008*/ 0x72, 0x39,// jb short 123456789ABCDE43h
			/*000A*/ (byte)0xB0, 0x02,// mov al,2
			/*000C*/ 0x73, 0x36,// jae short 123456789ABCDE44h
			/*000E*/ (byte)0xB0, 0x03,// mov al,3
			/*0010*/ 0x74, 0x33,// je short 123456789ABCDE45h
			/*0012*/ (byte)0xB0, 0x04,// mov al,4
			/*0014*/ 0x75, 0x30,// jne short 123456789ABCDE46h
			/*0016*/ (byte)0xB0, 0x05,// mov al,5
			/*0018*/ 0x76, 0x2D,// jbe short 123456789ABCDE47h
			/*001A*/ (byte)0xB0, 0x06,// mov al,6
			/*001C*/ 0x77, 0x2A,// ja short 123456789ABCDE48h
			/*001E*/ (byte)0xB0, 0x07,// mov al,7
			/*0020*/ 0x78, 0x27,// js short 123456789ABCDE49h
			/*0022*/ (byte)0xB0, 0x08,// mov al,8
			/*0024*/ 0x79, 0x24,// jns short 123456789ABCDE4Ah
			/*0026*/ (byte)0xB0, 0x09,// mov al,9
			/*0028*/ 0x7A, 0x21,// jp short 123456789ABCDE4Bh
			/*002A*/ (byte)0xB0, 0x0A,// mov al,0Ah
			/*002C*/ 0x7B, 0x1E,// jnp short 123456789ABCDE4Ch
			/*002E*/ (byte)0xB0, 0x0B,// mov al,0Bh
			/*0030*/ 0x7C, 0x1B,// jl short 123456789ABCDE4Dh
			/*0032*/ (byte)0xB0, 0x0C,// mov al,0Ch
			/*0034*/ 0x7D, 0x18,// jge short 123456789ABCDE4Eh
			/*0036*/ (byte)0xB0, 0x0D,// mov al,0Dh
			/*0038*/ 0x7E, 0x15,// jle short 123456789ABCDE4Fh
			/*003A*/ (byte)0xB0, 0x0E,// mov al,0Eh
			/*003C*/ 0x7F, 0x12,// jg short 123456789ABCDE50h
			/*003E*/ (byte)0xB0, 0x0F,// mov al,0Fh
			/*0040*/ (byte)0x90,// nop
		};
		byte[] newData = new byte[] {
			/*0000*/ 0x71, 0x06,// jno short 8000000000000008h
			/*0002*/ (byte)0xFF, 0x25, (byte)0xA0, 0x00, 0x00, 0x00,// jmp qword ptr [80000000000000A8h]
			/*0008*/ (byte)0xB0, 0x00,// mov al,0
			/*000A*/ 0x70, 0x06,// jo short 8000000000000012h
			/*000C*/ (byte)0xFF, 0x25, (byte)0x9E, 0x00, 0x00, 0x00,// jmp qword ptr [80000000000000B0h]
			/*0012*/ (byte)0xB0, 0x01,// mov al,1
			/*0014*/ 0x73, 0x06,// jae short 800000000000001Ch
			/*0016*/ (byte)0xFF, 0x25, (byte)0x9C, 0x00, 0x00, 0x00,// jmp qword ptr [80000000000000B8h]
			/*001C*/ (byte)0xB0, 0x02,// mov al,2
			/*001E*/ 0x72, 0x06,// jb short 8000000000000026h
			/*0020*/ (byte)0xFF, 0x25, (byte)0x9A, 0x00, 0x00, 0x00,// jmp qword ptr [80000000000000C0h]
			/*0026*/ (byte)0xB0, 0x03,// mov al,3
			/*0028*/ 0x75, 0x06,// jne short 8000000000000030h
			/*002A*/ (byte)0xFF, 0x25, (byte)0x98, 0x00, 0x00, 0x00,// jmp qword ptr [80000000000000C8h]
			/*0030*/ (byte)0xB0, 0x04,// mov al,4
			/*0032*/ 0x74, 0x06,// je short 800000000000003Ah
			/*0034*/ (byte)0xFF, 0x25, (byte)0x96, 0x00, 0x00, 0x00,// jmp qword ptr [80000000000000D0h]
			/*003A*/ (byte)0xB0, 0x05,// mov al,5
			/*003C*/ 0x77, 0x06,// ja short 8000000000000044h
			/*003E*/ (byte)0xFF, 0x25, (byte)0x94, 0x00, 0x00, 0x00,// jmp qword ptr [80000000000000D8h]
			/*0044*/ (byte)0xB0, 0x06,// mov al,6
			/*0046*/ 0x76, 0x06,// jbe short 800000000000004Eh
			/*0048*/ (byte)0xFF, 0x25, (byte)0x92, 0x00, 0x00, 0x00,// jmp qword ptr [80000000000000E0h]
			/*004E*/ (byte)0xB0, 0x07,// mov al,7
			/*0050*/ 0x79, 0x06,// jns short 8000000000000058h
			/*0052*/ (byte)0xFF, 0x25, (byte)0x90, 0x00, 0x00, 0x00,// jmp qword ptr [80000000000000E8h]
			/*0058*/ (byte)0xB0, 0x08,// mov al,8
			/*005A*/ 0x78, 0x06,// js short 8000000000000062h
			/*005C*/ (byte)0xFF, 0x25, (byte)0x8E, 0x00, 0x00, 0x00,// jmp qword ptr [80000000000000F0h]
			/*0062*/ (byte)0xB0, 0x09,// mov al,9
			/*0064*/ 0x7B, 0x06,// jnp short 800000000000006Ch
			/*0066*/ (byte)0xFF, 0x25, (byte)0x8C, 0x00, 0x00, 0x00,// jmp qword ptr [80000000000000F8h]
			/*006C*/ (byte)0xB0, 0x0A,// mov al,0Ah
			/*006E*/ 0x7A, 0x06,// jp short 8000000000000076h
			/*0070*/ (byte)0xFF, 0x25, (byte)0x8A, 0x00, 0x00, 0x00,// jmp qword ptr [8000000000000100h]
			/*0076*/ (byte)0xB0, 0x0B,// mov al,0Bh
			/*0078*/ 0x7D, 0x06,// jge short 8000000000000080h
			/*007A*/ (byte)0xFF, 0x25, (byte)0x88, 0x00, 0x00, 0x00,// jmp qword ptr [8000000000000108h]
			/*0080*/ (byte)0xB0, 0x0C,// mov al,0Ch
			/*0082*/ 0x7C, 0x06,// jl short 800000000000008Ah
			/*0084*/ (byte)0xFF, 0x25, (byte)0x86, 0x00, 0x00, 0x00,// jmp qword ptr [8000000000000110h]
			/*008A*/ (byte)0xB0, 0x0D,// mov al,0Dh
			/*008C*/ 0x7F, 0x06,// jg short 8000000000000094h
			/*008E*/ (byte)0xFF, 0x25, (byte)0x84, 0x00, 0x00, 0x00,// jmp qword ptr [8000000000000118h]
			/*0094*/ (byte)0xB0, 0x0E,// mov al,0Eh
			/*0096*/ 0x7E, 0x06,// jle short 800000000000009Eh
			/*0098*/ (byte)0xFF, 0x25, (byte)0x82, 0x00, 0x00, 0x00,// jmp qword ptr [8000000000000120h]
			/*009E*/ (byte)0xB0, 0x0F,// mov al,0Fh
			/*00A0*/ (byte)0x90,// nop
			/*00A1*/ (byte)0xCC, (byte)0xCC, (byte)0xCC, (byte)0xCC, (byte)0xCC, (byte)0xCC, (byte)0xCC,
			/*00A8*/ 0x41, (byte)0xDE, (byte)0xBC, (byte)0x9A, 0x78, 0x56, 0x34, 0x12,
			/*00B0*/ 0x42, (byte)0xDE, (byte)0xBC, (byte)0x9A, 0x78, 0x56, 0x34, 0x12,
			/*00B8*/ 0x43, (byte)0xDE, (byte)0xBC, (byte)0x9A, 0x78, 0x56, 0x34, 0x12,
			/*00C0*/ 0x44, (byte)0xDE, (byte)0xBC, (byte)0x9A, 0x78, 0x56, 0x34, 0x12,
			/*00C8*/ 0x45, (byte)0xDE, (byte)0xBC, (byte)0x9A, 0x78, 0x56, 0x34, 0x12,
			/*00D0*/ 0x46, (byte)0xDE, (byte)0xBC, (byte)0x9A, 0x78, 0x56, 0x34, 0x12,
			/*00D8*/ 0x47, (byte)0xDE, (byte)0xBC, (byte)0x9A, 0x78, 0x56, 0x34, 0x12,
			/*00E0*/ 0x48, (byte)0xDE, (byte)0xBC, (byte)0x9A, 0x78, 0x56, 0x34, 0x12,
			/*00E8*/ 0x49, (byte)0xDE, (byte)0xBC, (byte)0x9A, 0x78, 0x56, 0x34, 0x12,
			/*00F0*/ 0x4A, (byte)0xDE, (byte)0xBC, (byte)0x9A, 0x78, 0x56, 0x34, 0x12,
			/*00F8*/ 0x4B, (byte)0xDE, (byte)0xBC, (byte)0x9A, 0x78, 0x56, 0x34, 0x12,
			/*0100*/ 0x4C, (byte)0xDE, (byte)0xBC, (byte)0x9A, 0x78, 0x56, 0x34, 0x12,
			/*0108*/ 0x4D, (byte)0xDE, (byte)0xBC, (byte)0x9A, 0x78, 0x56, 0x34, 0x12,
			/*0110*/ 0x4E, (byte)0xDE, (byte)0xBC, (byte)0x9A, 0x78, 0x56, 0x34, 0x12,
			/*0118*/ 0x4F, (byte)0xDE, (byte)0xBC, (byte)0x9A, 0x78, 0x56, 0x34, 0x12,
			/*0120*/ 0x50, (byte)0xDE, (byte)0xBC, (byte)0x9A, 0x78, 0x56, 0x34, 0x12,
		};
		int[] expectedInstructionOffsets = new int[] {
			0xFFFF_FFFF,
			0x0008,
			0xFFFF_FFFF,
			0x0012,
			0xFFFF_FFFF,
			0x001C,
			0xFFFF_FFFF,
			0x0026,
			0xFFFF_FFFF,
			0x0030,
			0xFFFF_FFFF,
			0x003A,
			0xFFFF_FFFF,
			0x0044,
			0xFFFF_FFFF,
			0x004E,
			0xFFFF_FFFF,
			0x0058,
			0xFFFF_FFFF,
			0x0062,
			0xFFFF_FFFF,
			0x006C,
			0xFFFF_FFFF,
			0x0076,
			0xFFFF_FFFF,
			0x0080,
			0xFFFF_FFFF,
			0x008A,
			0xFFFF_FFFF,
			0x0094,
			0xFFFF_FFFF,
			0x009E,
			0x00A0,
		};
		RelocInfo[] expectedRelocInfos = new RelocInfo[] {
			new RelocInfo(RelocKind.OFFSET64, 0x80000000000000A8L),
			new RelocInfo(RelocKind.OFFSET64, 0x80000000000000B0L),
			new RelocInfo(RelocKind.OFFSET64, 0x80000000000000B8L),
			new RelocInfo(RelocKind.OFFSET64, 0x80000000000000C0L),
			new RelocInfo(RelocKind.OFFSET64, 0x80000000000000C8L),
			new RelocInfo(RelocKind.OFFSET64, 0x80000000000000D0L),
			new RelocInfo(RelocKind.OFFSET64, 0x80000000000000D8L),
			new RelocInfo(RelocKind.OFFSET64, 0x80000000000000E0L),
			new RelocInfo(RelocKind.OFFSET64, 0x80000000000000E8L),
			new RelocInfo(RelocKind.OFFSET64, 0x80000000000000F0L),
			new RelocInfo(RelocKind.OFFSET64, 0x80000000000000F8L),
			new RelocInfo(RelocKind.OFFSET64, 0x8000000000000100L),
			new RelocInfo(RelocKind.OFFSET64, 0x8000000000000108L),
			new RelocInfo(RelocKind.OFFSET64, 0x8000000000000110L),
			new RelocInfo(RelocKind.OFFSET64, 0x8000000000000118L),
			new RelocInfo(RelocKind.OFFSET64, 0x8000000000000120L),
		};
		final int options = BlockEncoderOptions.NONE;
		final long origRip = 0x123456789ABCDE00L;
		encodeBase(bitness, origRip, originalData, newRip, newData, options, DECODER_OPTIONS, expectedInstructionOffsets, expectedRelocInfos);
	}

	@Test
	void jcc_near_fwd_short() {
		byte[] originalData = new byte[] {
			/*0000*/ 0x0F, (byte)0x80, 0x7A, 0x00, 0x00, 0x00,// jo near ptr 0000000000008080h
			/*0006*/ (byte)0xB0, 0x00,// mov al,0
			/*0008*/ 0x0F, (byte)0x81, 0x72, 0x00, 0x00, 0x00,// jno near ptr 0000000000008080h
			/*000E*/ (byte)0xB0, 0x01,// mov al,1
			/*0010*/ 0x0F, (byte)0x82, 0x6A, 0x00, 0x00, 0x00,// jb near ptr 0000000000008080h
			/*0016*/ (byte)0xB0, 0x02,// mov al,2
			/*0018*/ 0x0F, (byte)0x83, 0x62, 0x00, 0x00, 0x00,// jae near ptr 0000000000008080h
			/*001E*/ (byte)0xB0, 0x03,// mov al,3
			/*0020*/ 0x0F, (byte)0x84, 0x5A, 0x00, 0x00, 0x00,// je near ptr 0000000000008080h
			/*0026*/ (byte)0xB0, 0x04,// mov al,4
			/*0028*/ 0x0F, (byte)0x85, 0x52, 0x00, 0x00, 0x00,// jne near ptr 0000000000008080h
			/*002E*/ (byte)0xB0, 0x05,// mov al,5
			/*0030*/ 0x0F, (byte)0x86, 0x4A, 0x00, 0x00, 0x00,// jbe near ptr 0000000000008080h
			/*0036*/ (byte)0xB0, 0x06,// mov al,6
			/*0038*/ 0x0F, (byte)0x87, 0x42, 0x00, 0x00, 0x00,// ja near ptr 0000000000008080h
			/*003E*/ (byte)0xB0, 0x07,// mov al,7
			/*0040*/ 0x0F, (byte)0x88, 0x3A, 0x00, 0x00, 0x00,// js near ptr 0000000000008080h
			/*0046*/ (byte)0xB0, 0x08,// mov al,8
			/*0048*/ 0x0F, (byte)0x89, 0x32, 0x00, 0x00, 0x00,// jns near ptr 0000000000008080h
			/*004E*/ (byte)0xB0, 0x09,// mov al,9
			/*0050*/ 0x0F, (byte)0x8A, 0x2A, 0x00, 0x00, 0x00,// jp near ptr 0000000000008080h
			/*0056*/ (byte)0xB0, 0x0A,// mov al,0Ah
			/*0058*/ 0x0F, (byte)0x8B, 0x22, 0x00, 0x00, 0x00,// jnp near ptr 0000000000008080h
			/*005E*/ (byte)0xB0, 0x0B,// mov al,0Bh
			/*0060*/ 0x0F, (byte)0x8C, 0x1A, 0x00, 0x00, 0x00,// jl near ptr 0000000000008080h
			/*0066*/ (byte)0xB0, 0x0C,// mov al,0Ch
			/*0068*/ 0x0F, (byte)0x8D, 0x12, 0x00, 0x00, 0x00,// jge near ptr 0000000000008080h
			/*006E*/ (byte)0xB0, 0x0D,// mov al,0Dh
			/*0070*/ 0x0F, (byte)0x8E, 0x0A, 0x00, 0x00, 0x00,// jle near ptr 0000000000008080h
			/*0076*/ (byte)0xB0, 0x0E,// mov al,0Eh
			/*0078*/ 0x0F, (byte)0x8F, 0x02, 0x00, 0x00, 0x00,// jg near ptr 0000000000008080h
			/*007E*/ (byte)0xB0, 0x0F,// mov al,0Fh
			/*0080*/ (byte)0xB0, 0x10,// mov al,10h
		};
		byte[] newData = new byte[] {
			/*0000*/ 0x70, 0x3E,// jo short 8000000000000040h
			/*0002*/ (byte)0xB0, 0x00,// mov al,0
			/*0004*/ 0x71, 0x3A,// jno short 8000000000000040h
			/*0006*/ (byte)0xB0, 0x01,// mov al,1
			/*0008*/ 0x72, 0x36,// jb short 8000000000000040h
			/*000A*/ (byte)0xB0, 0x02,// mov al,2
			/*000C*/ 0x73, 0x32,// jae short 8000000000000040h
			/*000E*/ (byte)0xB0, 0x03,// mov al,3
			/*0010*/ 0x74, 0x2E,// je short 8000000000000040h
			/*0012*/ (byte)0xB0, 0x04,// mov al,4
			/*0014*/ 0x75, 0x2A,// jne short 8000000000000040h
			/*0016*/ (byte)0xB0, 0x05,// mov al,5
			/*0018*/ 0x76, 0x26,// jbe short 8000000000000040h
			/*001A*/ (byte)0xB0, 0x06,// mov al,6
			/*001C*/ 0x77, 0x22,// ja short 8000000000000040h
			/*001E*/ (byte)0xB0, 0x07,// mov al,7
			/*0020*/ 0x78, 0x1E,// js short 8000000000000040h
			/*0022*/ (byte)0xB0, 0x08,// mov al,8
			/*0024*/ 0x79, 0x1A,// jns short 8000000000000040h
			/*0026*/ (byte)0xB0, 0x09,// mov al,9
			/*0028*/ 0x7A, 0x16,// jp short 8000000000000040h
			/*002A*/ (byte)0xB0, 0x0A,// mov al,0Ah
			/*002C*/ 0x7B, 0x12,// jnp short 8000000000000040h
			/*002E*/ (byte)0xB0, 0x0B,// mov al,0Bh
			/*0030*/ 0x7C, 0x0E,// jl short 8000000000000040h
			/*0032*/ (byte)0xB0, 0x0C,// mov al,0Ch
			/*0034*/ 0x7D, 0x0A,// jge short 8000000000000040h
			/*0036*/ (byte)0xB0, 0x0D,// mov al,0Dh
			/*0038*/ 0x7E, 0x06,// jle short 8000000000000040h
			/*003A*/ (byte)0xB0, 0x0E,// mov al,0Eh
			/*003C*/ 0x7F, 0x02,// jg short 8000000000000040h
			/*003E*/ (byte)0xB0, 0x0F,// mov al,0Fh
			/*0040*/ (byte)0xB0, 0x10,// mov al,10h
		};
		int[] expectedInstructionOffsets = new int[] {
			0x0000,
			0x0002,
			0x0004,
			0x0006,
			0x0008,
			0x000A,
			0x000C,
			0x000E,
			0x0010,
			0x0012,
			0x0014,
			0x0016,
			0x0018,
			0x001A,
			0x001C,
			0x001E,
			0x0020,
			0x0022,
			0x0024,
			0x0026,
			0x0028,
			0x002A,
			0x002C,
			0x002E,
			0x0030,
			0x0032,
			0x0034,
			0x0036,
			0x0038,
			0x003A,
			0x003C,
			0x003E,
			0x0040,
		};
		RelocInfo[] expectedRelocInfos = new RelocInfo[0];
		final int options = BlockEncoderOptions.NONE;
		encodeBase(bitness, origRip, originalData, newRip, newData, options, DECODER_OPTIONS, expectedInstructionOffsets, expectedRelocInfos);
	}

	@Test
	void jcc_near_fwd_near() {
		byte[] originalData = new byte[] {
			/*0000*/ 0x0F, (byte)0x80, 0x14, 0x01, 0x00, 0x00,// jo near ptr 000000000000811Ah
			/*0006*/ (byte)0xB0, 0x00,// mov al,0
			/*0008*/ 0x0F, (byte)0x81, 0x0C, 0x01, 0x00, 0x00,// jno near ptr 000000000000811Ah
			/*000E*/ (byte)0xB0, 0x01,// mov al,1
			/*0010*/ 0x0F, (byte)0x82, 0x04, 0x01, 0x00, 0x00,// jb near ptr 000000000000811Ah
			/*0016*/ (byte)0xB0, 0x02,// mov al,2
			/*0018*/ 0x0F, (byte)0x83, (byte)0xFC, 0x00, 0x00, 0x00,// jae near ptr 000000000000811Ah
			/*001E*/ (byte)0xB0, 0x03,// mov al,3
			/*0020*/ 0x0F, (byte)0x84, (byte)0xF4, 0x00, 0x00, 0x00,// je near ptr 000000000000811Ah
			/*0026*/ (byte)0xB0, 0x04,// mov al,4
			/*0028*/ 0x0F, (byte)0x85, (byte)0xEC, 0x00, 0x00, 0x00,// jne near ptr 000000000000811Ah
			/*002E*/ (byte)0xB0, 0x05,// mov al,5
			/*0030*/ 0x0F, (byte)0x86, (byte)0xE4, 0x00, 0x00, 0x00,// jbe near ptr 000000000000811Ah
			/*0036*/ (byte)0xB0, 0x06,// mov al,6
			/*0038*/ 0x0F, (byte)0x87, (byte)0xDC, 0x00, 0x00, 0x00,// ja near ptr 000000000000811Ah
			/*003E*/ (byte)0xB0, 0x07,// mov al,7
			/*0040*/ 0x0F, (byte)0x88, (byte)0xD4, 0x00, 0x00, 0x00,// js near ptr 000000000000811Ah
			/*0046*/ (byte)0xB0, 0x08,// mov al,8
			/*0048*/ 0x0F, (byte)0x89, (byte)0xCC, 0x00, 0x00, 0x00,// jns near ptr 000000000000811Ah
			/*004E*/ (byte)0xB0, 0x09,// mov al,9
			/*0050*/ 0x0F, (byte)0x8A, (byte)0xC4, 0x00, 0x00, 0x00,// jp near ptr 000000000000811Ah
			/*0056*/ (byte)0xB0, 0x0A,// mov al,0Ah
			/*0058*/ 0x0F, (byte)0x8B, (byte)0xBC, 0x00, 0x00, 0x00,// jnp near ptr 000000000000811Ah
			/*005E*/ (byte)0xB0, 0x0B,// mov al,0Bh
			/*0060*/ 0x0F, (byte)0x8C, (byte)0xB4, 0x00, 0x00, 0x00,// jl near ptr 000000000000811Ah
			/*0066*/ (byte)0xB0, 0x0C,// mov al,0Ch
			/*0068*/ 0x0F, (byte)0x8D, (byte)0xAC, 0x00, 0x00, 0x00,// jge near ptr 000000000000811Ah
			/*006E*/ (byte)0xB0, 0x0D,// mov al,0Dh
			/*0070*/ 0x0F, (byte)0x8E, (byte)0xA4, 0x00, 0x00, 0x00,// jle near ptr 000000000000811Ah
			/*0076*/ (byte)0xB0, 0x0E,// mov al,0Eh
			/*0078*/ 0x0F, (byte)0x8F, (byte)0x9C, 0x00, 0x00, 0x00,// jg near ptr 000000000000811Ah
			/*007E*/ 0x64, 0x67, (byte)0xC7, (byte)0x84, 0x0B, 0x78, 0x56, 0x34, 0x12, 0x78, 0x56, 0x34, 0x12,// mov dword ptr fs:[ebx+ecx+12345678h],12345678h
			/*008B*/ 0x64, 0x67, (byte)0xC7, (byte)0x84, 0x0B, 0x78, 0x56, 0x34, 0x12, 0x78, 0x56, 0x34, 0x12,// mov dword ptr fs:[ebx+ecx+12345678h],12345678h
			/*0098*/ 0x64, 0x67, (byte)0xC7, (byte)0x84, 0x0B, 0x78, 0x56, 0x34, 0x12, 0x78, 0x56, 0x34, 0x12,// mov dword ptr fs:[ebx+ecx+12345678h],12345678h
			/*00A5*/ 0x64, 0x67, (byte)0xC7, (byte)0x84, 0x0B, 0x78, 0x56, 0x34, 0x12, 0x78, 0x56, 0x34, 0x12,// mov dword ptr fs:[ebx+ecx+12345678h],12345678h
			/*00B2*/ 0x64, 0x67, (byte)0xC7, (byte)0x84, 0x0B, 0x78, 0x56, 0x34, 0x12, 0x78, 0x56, 0x34, 0x12,// mov dword ptr fs:[ebx+ecx+12345678h],12345678h
			/*00BF*/ 0x64, 0x67, (byte)0xC7, (byte)0x84, 0x0B, 0x78, 0x56, 0x34, 0x12, 0x78, 0x56, 0x34, 0x12,// mov dword ptr fs:[ebx+ecx+12345678h],12345678h
			/*00CC*/ 0x64, 0x67, (byte)0xC7, (byte)0x84, 0x0B, 0x78, 0x56, 0x34, 0x12, 0x78, 0x56, 0x34, 0x12,// mov dword ptr fs:[ebx+ecx+12345678h],12345678h
			/*00D9*/ 0x64, 0x67, (byte)0xC7, (byte)0x84, 0x0B, 0x78, 0x56, 0x34, 0x12, 0x78, 0x56, 0x34, 0x12,// mov dword ptr fs:[ebx+ecx+12345678h],12345678h
			/*00E6*/ 0x64, 0x67, (byte)0xC7, (byte)0x84, 0x0B, 0x78, 0x56, 0x34, 0x12, 0x78, 0x56, 0x34, 0x12,// mov dword ptr fs:[ebx+ecx+12345678h],12345678h
			/*00F3*/ 0x64, 0x67, (byte)0xC7, (byte)0x84, 0x0B, 0x78, 0x56, 0x34, 0x12, 0x78, 0x56, 0x34, 0x12,// mov dword ptr fs:[ebx+ecx+12345678h],12345678h
			/*0100*/ 0x64, 0x67, (byte)0xC7, (byte)0x84, 0x0B, 0x78, 0x56, 0x34, 0x12, 0x78, 0x56, 0x34, 0x12,// mov dword ptr fs:[ebx+ecx+12345678h],12345678h
			/*010D*/ 0x64, 0x67, (byte)0xC7, (byte)0x84, 0x0B, 0x78, 0x56, 0x34, 0x12, 0x78, 0x56, 0x34, 0x12,// mov dword ptr fs:[ebx+ecx+12345678h],12345678h
			/*011A*/ (byte)0xB0, 0x10,// mov al,10h
		};
		byte[] newData = new byte[] {
			/*0000*/ 0x0F, (byte)0x80, 0x14, 0x01, 0x00, 0x00,// jo near ptr 800000000000011Ah
			/*0006*/ (byte)0xB0, 0x00,// mov al,0
			/*0008*/ 0x0F, (byte)0x81, 0x0C, 0x01, 0x00, 0x00,// jno near ptr 800000000000011Ah
			/*000E*/ (byte)0xB0, 0x01,// mov al,1
			/*0010*/ 0x0F, (byte)0x82, 0x04, 0x01, 0x00, 0x00,// jb near ptr 800000000000011Ah
			/*0016*/ (byte)0xB0, 0x02,// mov al,2
			/*0018*/ 0x0F, (byte)0x83, (byte)0xFC, 0x00, 0x00, 0x00,// jae near ptr 800000000000011Ah
			/*001E*/ (byte)0xB0, 0x03,// mov al,3
			/*0020*/ 0x0F, (byte)0x84, (byte)0xF4, 0x00, 0x00, 0x00,// je near ptr 800000000000011Ah
			/*0026*/ (byte)0xB0, 0x04,// mov al,4
			/*0028*/ 0x0F, (byte)0x85, (byte)0xEC, 0x00, 0x00, 0x00,// jne near ptr 800000000000011Ah
			/*002E*/ (byte)0xB0, 0x05,// mov al,5
			/*0030*/ 0x0F, (byte)0x86, (byte)0xE4, 0x00, 0x00, 0x00,// jbe near ptr 800000000000011Ah
			/*0036*/ (byte)0xB0, 0x06,// mov al,6
			/*0038*/ 0x0F, (byte)0x87, (byte)0xDC, 0x00, 0x00, 0x00,// ja near ptr 800000000000011Ah
			/*003E*/ (byte)0xB0, 0x07,// mov al,7
			/*0040*/ 0x0F, (byte)0x88, (byte)0xD4, 0x00, 0x00, 0x00,// js near ptr 800000000000011Ah
			/*0046*/ (byte)0xB0, 0x08,// mov al,8
			/*0048*/ 0x0F, (byte)0x89, (byte)0xCC, 0x00, 0x00, 0x00,// jns near ptr 800000000000011Ah
			/*004E*/ (byte)0xB0, 0x09,// mov al,9
			/*0050*/ 0x0F, (byte)0x8A, (byte)0xC4, 0x00, 0x00, 0x00,// jp near ptr 800000000000011Ah
			/*0056*/ (byte)0xB0, 0x0A,// mov al,0Ah
			/*0058*/ 0x0F, (byte)0x8B, (byte)0xBC, 0x00, 0x00, 0x00,// jnp near ptr 800000000000011Ah
			/*005E*/ (byte)0xB0, 0x0B,// mov al,0Bh
			/*0060*/ 0x0F, (byte)0x8C, (byte)0xB4, 0x00, 0x00, 0x00,// jl near ptr 800000000000011Ah
			/*0066*/ (byte)0xB0, 0x0C,// mov al,0Ch
			/*0068*/ 0x0F, (byte)0x8D, (byte)0xAC, 0x00, 0x00, 0x00,// jge near ptr 800000000000011Ah
			/*006E*/ (byte)0xB0, 0x0D,// mov al,0Dh
			/*0070*/ 0x0F, (byte)0x8E, (byte)0xA4, 0x00, 0x00, 0x00,// jle near ptr 800000000000011Ah
			/*0076*/ (byte)0xB0, 0x0E,// mov al,0Eh
			/*0078*/ 0x0F, (byte)0x8F, (byte)0x9C, 0x00, 0x00, 0x00,// jg near ptr 800000000000011Ah
			/*007E*/ 0x64, 0x67, (byte)0xC7, (byte)0x84, 0x0B, 0x78, 0x56, 0x34, 0x12, 0x78, 0x56, 0x34, 0x12,// mov dword ptr fs:[ebx+ecx+12345678h],12345678h
			/*008B*/ 0x64, 0x67, (byte)0xC7, (byte)0x84, 0x0B, 0x78, 0x56, 0x34, 0x12, 0x78, 0x56, 0x34, 0x12,// mov dword ptr fs:[ebx+ecx+12345678h],12345678h
			/*0098*/ 0x64, 0x67, (byte)0xC7, (byte)0x84, 0x0B, 0x78, 0x56, 0x34, 0x12, 0x78, 0x56, 0x34, 0x12,// mov dword ptr fs:[ebx+ecx+12345678h],12345678h
			/*00A5*/ 0x64, 0x67, (byte)0xC7, (byte)0x84, 0x0B, 0x78, 0x56, 0x34, 0x12, 0x78, 0x56, 0x34, 0x12,// mov dword ptr fs:[ebx+ecx+12345678h],12345678h
			/*00B2*/ 0x64, 0x67, (byte)0xC7, (byte)0x84, 0x0B, 0x78, 0x56, 0x34, 0x12, 0x78, 0x56, 0x34, 0x12,// mov dword ptr fs:[ebx+ecx+12345678h],12345678h
			/*00BF*/ 0x64, 0x67, (byte)0xC7, (byte)0x84, 0x0B, 0x78, 0x56, 0x34, 0x12, 0x78, 0x56, 0x34, 0x12,// mov dword ptr fs:[ebx+ecx+12345678h],12345678h
			/*00CC*/ 0x64, 0x67, (byte)0xC7, (byte)0x84, 0x0B, 0x78, 0x56, 0x34, 0x12, 0x78, 0x56, 0x34, 0x12,// mov dword ptr fs:[ebx+ecx+12345678h],12345678h
			/*00D9*/ 0x64, 0x67, (byte)0xC7, (byte)0x84, 0x0B, 0x78, 0x56, 0x34, 0x12, 0x78, 0x56, 0x34, 0x12,// mov dword ptr fs:[ebx+ecx+12345678h],12345678h
			/*00E6*/ 0x64, 0x67, (byte)0xC7, (byte)0x84, 0x0B, 0x78, 0x56, 0x34, 0x12, 0x78, 0x56, 0x34, 0x12,// mov dword ptr fs:[ebx+ecx+12345678h],12345678h
			/*00F3*/ 0x64, 0x67, (byte)0xC7, (byte)0x84, 0x0B, 0x78, 0x56, 0x34, 0x12, 0x78, 0x56, 0x34, 0x12,// mov dword ptr fs:[ebx+ecx+12345678h],12345678h
			/*0100*/ 0x64, 0x67, (byte)0xC7, (byte)0x84, 0x0B, 0x78, 0x56, 0x34, 0x12, 0x78, 0x56, 0x34, 0x12,// mov dword ptr fs:[ebx+ecx+12345678h],12345678h
			/*010D*/ 0x64, 0x67, (byte)0xC7, (byte)0x84, 0x0B, 0x78, 0x56, 0x34, 0x12, 0x78, 0x56, 0x34, 0x12,// mov dword ptr fs:[ebx+ecx+12345678h],12345678h
			/*011A*/ (byte)0xB0, 0x10,// mov al,10h
		};
		int[] expectedInstructionOffsets = new int[] {
			0x0000,
			0x0006,
			0x0008,
			0x000E,
			0x0010,
			0x0016,
			0x0018,
			0x001E,
			0x0020,
			0x0026,
			0x0028,
			0x002E,
			0x0030,
			0x0036,
			0x0038,
			0x003E,
			0x0040,
			0x0046,
			0x0048,
			0x004E,
			0x0050,
			0x0056,
			0x0058,
			0x005E,
			0x0060,
			0x0066,
			0x0068,
			0x006E,
			0x0070,
			0x0076,
			0x0078,
			0x007E,
			0x008B,
			0x0098,
			0x00A5,
			0x00B2,
			0x00BF,
			0x00CC,
			0x00D9,
			0x00E6,
			0x00F3,
			0x0100,
			0x010D,
			0x011A,
		};
		RelocInfo[] expectedRelocInfos = new RelocInfo[0];
		final int options = BlockEncoderOptions.NONE;
		encodeBase(bitness, origRip, originalData, newRip, newData, options, DECODER_OPTIONS, expectedInstructionOffsets, expectedRelocInfos);
	}

	@Test
	void jcc_near_bwd_short() {
		byte[] originalData = new byte[] {
			/*0000*/ 0x0F, (byte)0x80, (byte)0xFA, (byte)0xFF, (byte)0xFF, (byte)0xFF,// jo near ptr 0000000000008000h
			/*0006*/ (byte)0xB0, 0x00,// mov al,0
			/*0008*/ 0x0F, (byte)0x81, (byte)0xF2, (byte)0xFF, (byte)0xFF, (byte)0xFF,// jno near ptr 0000000000008000h
			/*000E*/ (byte)0xB0, 0x01,// mov al,1
			/*0010*/ 0x0F, (byte)0x82, (byte)0xEA, (byte)0xFF, (byte)0xFF, (byte)0xFF,// jb near ptr 0000000000008000h
			/*0016*/ (byte)0xB0, 0x02,// mov al,2
			/*0018*/ 0x0F, (byte)0x83, (byte)0xE2, (byte)0xFF, (byte)0xFF, (byte)0xFF,// jae near ptr 0000000000008000h
			/*001E*/ (byte)0xB0, 0x03,// mov al,3
			/*0020*/ 0x0F, (byte)0x84, (byte)0xDA, (byte)0xFF, (byte)0xFF, (byte)0xFF,// je near ptr 0000000000008000h
			/*0026*/ (byte)0xB0, 0x04,// mov al,4
			/*0028*/ 0x0F, (byte)0x85, (byte)0xD2, (byte)0xFF, (byte)0xFF, (byte)0xFF,// jne near ptr 0000000000008000h
			/*002E*/ (byte)0xB0, 0x05,// mov al,5
			/*0030*/ 0x0F, (byte)0x86, (byte)0xCA, (byte)0xFF, (byte)0xFF, (byte)0xFF,// jbe near ptr 0000000000008000h
			/*0036*/ (byte)0xB0, 0x06,// mov al,6
			/*0038*/ 0x0F, (byte)0x87, (byte)0xC2, (byte)0xFF, (byte)0xFF, (byte)0xFF,// ja near ptr 0000000000008000h
			/*003E*/ (byte)0xB0, 0x07,// mov al,7
			/*0040*/ 0x0F, (byte)0x88, (byte)0xBA, (byte)0xFF, (byte)0xFF, (byte)0xFF,// js near ptr 0000000000008000h
			/*0046*/ (byte)0xB0, 0x08,// mov al,8
			/*0048*/ 0x0F, (byte)0x89, (byte)0xB2, (byte)0xFF, (byte)0xFF, (byte)0xFF,// jns near ptr 0000000000008000h
			/*004E*/ (byte)0xB0, 0x09,// mov al,9
			/*0050*/ 0x0F, (byte)0x8A, (byte)0xAA, (byte)0xFF, (byte)0xFF, (byte)0xFF,// jp near ptr 0000000000008000h
			/*0056*/ (byte)0xB0, 0x0A,// mov al,0Ah
			/*0058*/ 0x0F, (byte)0x8B, (byte)0xA2, (byte)0xFF, (byte)0xFF, (byte)0xFF,// jnp near ptr 0000000000008000h
			/*005E*/ (byte)0xB0, 0x0B,// mov al,0Bh
			/*0060*/ 0x0F, (byte)0x8C, (byte)0x9A, (byte)0xFF, (byte)0xFF, (byte)0xFF,// jl near ptr 0000000000008000h
			/*0066*/ (byte)0xB0, 0x0C,// mov al,0Ch
			/*0068*/ 0x0F, (byte)0x8D, (byte)0x92, (byte)0xFF, (byte)0xFF, (byte)0xFF,// jge near ptr 0000000000008000h
			/*006E*/ (byte)0xB0, 0x0D,// mov al,0Dh
			/*0070*/ 0x0F, (byte)0x8E, (byte)0x8A, (byte)0xFF, (byte)0xFF, (byte)0xFF,// jle near ptr 0000000000008000h
			/*0076*/ (byte)0xB0, 0x0E,// mov al,0Eh
			/*0078*/ 0x0F, (byte)0x8F, (byte)0x82, (byte)0xFF, (byte)0xFF, (byte)0xFF,// jg near ptr 0000000000008000h
			/*007E*/ (byte)0xB0, 0x0F,// mov al,0Fh
		};
		byte[] newData = new byte[] {
			/*0000*/ 0x70, (byte)0xFE,// jo short 8000000000000000h
			/*0002*/ (byte)0xB0, 0x00,// mov al,0
			/*0004*/ 0x71, (byte)0xFA,// jno short 8000000000000000h
			/*0006*/ (byte)0xB0, 0x01,// mov al,1
			/*0008*/ 0x72, (byte)0xF6,// jb short 8000000000000000h
			/*000A*/ (byte)0xB0, 0x02,// mov al,2
			/*000C*/ 0x73, (byte)0xF2,// jae short 8000000000000000h
			/*000E*/ (byte)0xB0, 0x03,// mov al,3
			/*0010*/ 0x74, (byte)0xEE,// je short 8000000000000000h
			/*0012*/ (byte)0xB0, 0x04,// mov al,4
			/*0014*/ 0x75, (byte)0xEA,// jne short 8000000000000000h
			/*0016*/ (byte)0xB0, 0x05,// mov al,5
			/*0018*/ 0x76, (byte)0xE6,// jbe short 8000000000000000h
			/*001A*/ (byte)0xB0, 0x06,// mov al,6
			/*001C*/ 0x77, (byte)0xE2,// ja short 8000000000000000h
			/*001E*/ (byte)0xB0, 0x07,// mov al,7
			/*0020*/ 0x78, (byte)0xDE,// js short 8000000000000000h
			/*0022*/ (byte)0xB0, 0x08,// mov al,8
			/*0024*/ 0x79, (byte)0xDA,// jns short 8000000000000000h
			/*0026*/ (byte)0xB0, 0x09,// mov al,9
			/*0028*/ 0x7A, (byte)0xD6,// jp short 8000000000000000h
			/*002A*/ (byte)0xB0, 0x0A,// mov al,0Ah
			/*002C*/ 0x7B, (byte)0xD2,// jnp short 8000000000000000h
			/*002E*/ (byte)0xB0, 0x0B,// mov al,0Bh
			/*0030*/ 0x7C, (byte)0xCE,// jl short 8000000000000000h
			/*0032*/ (byte)0xB0, 0x0C,// mov al,0Ch
			/*0034*/ 0x7D, (byte)0xCA,// jge short 8000000000000000h
			/*0036*/ (byte)0xB0, 0x0D,// mov al,0Dh
			/*0038*/ 0x7E, (byte)0xC6,// jle short 8000000000000000h
			/*003A*/ (byte)0xB0, 0x0E,// mov al,0Eh
			/*003C*/ 0x7F, (byte)0xC2,// jg short 8000000000000000h
			/*003E*/ (byte)0xB0, 0x0F,// mov al,0Fh
		};
		int[] expectedInstructionOffsets = new int[] {
			0x0000,
			0x0002,
			0x0004,
			0x0006,
			0x0008,
			0x000A,
			0x000C,
			0x000E,
			0x0010,
			0x0012,
			0x0014,
			0x0016,
			0x0018,
			0x001A,
			0x001C,
			0x001E,
			0x0020,
			0x0022,
			0x0024,
			0x0026,
			0x0028,
			0x002A,
			0x002C,
			0x002E,
			0x0030,
			0x0032,
			0x0034,
			0x0036,
			0x0038,
			0x003A,
			0x003C,
			0x003E,
		};
		RelocInfo[] expectedRelocInfos = new RelocInfo[0];
		final int options = BlockEncoderOptions.NONE;
		encodeBase(bitness, origRip, originalData, newRip, newData, options, DECODER_OPTIONS, expectedInstructionOffsets, expectedRelocInfos);
	}

	@Test
	void jcc_near_bwd_near() {
		byte[] originalData = new byte[] {
			/*0000*/ 0x64, 0x67, (byte)0xC7, (byte)0x84, 0x0B, 0x78, 0x56, 0x34, 0x12, 0x78, 0x56, 0x34, 0x12,// mov dword ptr fs:[ebx+ecx+12345678h],12345678h
			/*000D*/ 0x64, 0x67, (byte)0xC7, (byte)0x84, 0x0B, 0x78, 0x56, 0x34, 0x12, 0x78, 0x56, 0x34, 0x12,// mov dword ptr fs:[ebx+ecx+12345678h],12345678h
			/*001A*/ 0x64, 0x67, (byte)0xC7, (byte)0x84, 0x0B, 0x78, 0x56, 0x34, 0x12, 0x78, 0x56, 0x34, 0x12,// mov dword ptr fs:[ebx+ecx+12345678h],12345678h
			/*0027*/ 0x64, 0x67, (byte)0xC7, (byte)0x84, 0x0B, 0x78, 0x56, 0x34, 0x12, 0x78, 0x56, 0x34, 0x12,// mov dword ptr fs:[ebx+ecx+12345678h],12345678h
			/*0034*/ 0x64, 0x67, (byte)0xC7, (byte)0x84, 0x0B, 0x78, 0x56, 0x34, 0x12, 0x78, 0x56, 0x34, 0x12,// mov dword ptr fs:[ebx+ecx+12345678h],12345678h
			/*0041*/ 0x64, 0x67, (byte)0xC7, (byte)0x84, 0x0B, 0x78, 0x56, 0x34, 0x12, 0x78, 0x56, 0x34, 0x12,// mov dword ptr fs:[ebx+ecx+12345678h],12345678h
			/*004E*/ 0x64, 0x67, (byte)0xC7, (byte)0x84, 0x0B, 0x78, 0x56, 0x34, 0x12, 0x78, 0x56, 0x34, 0x12,// mov dword ptr fs:[ebx+ecx+12345678h],12345678h
			/*005B*/ 0x64, 0x67, (byte)0xC7, (byte)0x84, 0x0B, 0x78, 0x56, 0x34, 0x12, 0x78, 0x56, 0x34, 0x12,// mov dword ptr fs:[ebx+ecx+12345678h],12345678h
			/*0068*/ 0x64, 0x67, (byte)0xC7, (byte)0x84, 0x0B, 0x78, 0x56, 0x34, 0x12, 0x78, 0x56, 0x34, 0x12,// mov dword ptr fs:[ebx+ecx+12345678h],12345678h
			/*0075*/ 0x64, 0x67, (byte)0xC7, (byte)0x84, 0x0B, 0x78, 0x56, 0x34, 0x12, 0x78, 0x56, 0x34, 0x12,// mov dword ptr fs:[ebx+ecx+12345678h],12345678h
			/*0082*/ 0x64, 0x67, (byte)0xC7, (byte)0x84, 0x0B, 0x78, 0x56, 0x34, 0x12, 0x78, 0x56, 0x34, 0x12,// mov dword ptr fs:[ebx+ecx+12345678h],12345678h
			/*008F*/ 0x64, 0x67, (byte)0xC7, (byte)0x84, 0x0B, 0x78, 0x56, 0x34, 0x12, 0x78, 0x56, 0x34, 0x12,// mov dword ptr fs:[ebx+ecx+12345678h],12345678h
			/*009C*/ 0x0F, (byte)0x80, 0x5E, (byte)0xFF, (byte)0xFF, (byte)0xFF,// jo near ptr 0000000000008000h
			/*00A2*/ (byte)0xB0, 0x00,// mov al,0
			/*00A4*/ 0x0F, (byte)0x81, 0x56, (byte)0xFF, (byte)0xFF, (byte)0xFF,// jno near ptr 0000000000008000h
			/*00AA*/ (byte)0xB0, 0x01,// mov al,1
			/*00AC*/ 0x0F, (byte)0x82, 0x4E, (byte)0xFF, (byte)0xFF, (byte)0xFF,// jb near ptr 0000000000008000h
			/*00B2*/ (byte)0xB0, 0x02,// mov al,2
			/*00B4*/ 0x0F, (byte)0x83, 0x46, (byte)0xFF, (byte)0xFF, (byte)0xFF,// jae near ptr 0000000000008000h
			/*00BA*/ (byte)0xB0, 0x03,// mov al,3
			/*00BC*/ 0x0F, (byte)0x84, 0x3E, (byte)0xFF, (byte)0xFF, (byte)0xFF,// je near ptr 0000000000008000h
			/*00C2*/ (byte)0xB0, 0x04,// mov al,4
			/*00C4*/ 0x0F, (byte)0x85, 0x36, (byte)0xFF, (byte)0xFF, (byte)0xFF,// jne near ptr 0000000000008000h
			/*00CA*/ (byte)0xB0, 0x05,// mov al,5
			/*00CC*/ 0x0F, (byte)0x86, 0x2E, (byte)0xFF, (byte)0xFF, (byte)0xFF,// jbe near ptr 0000000000008000h
			/*00D2*/ (byte)0xB0, 0x06,// mov al,6
			/*00D4*/ 0x0F, (byte)0x87, 0x26, (byte)0xFF, (byte)0xFF, (byte)0xFF,// ja near ptr 0000000000008000h
			/*00DA*/ (byte)0xB0, 0x07,// mov al,7
			/*00DC*/ 0x0F, (byte)0x88, 0x1E, (byte)0xFF, (byte)0xFF, (byte)0xFF,// js near ptr 0000000000008000h
			/*00E2*/ (byte)0xB0, 0x08,// mov al,8
			/*00E4*/ 0x0F, (byte)0x89, 0x16, (byte)0xFF, (byte)0xFF, (byte)0xFF,// jns near ptr 0000000000008000h
			/*00EA*/ (byte)0xB0, 0x09,// mov al,9
			/*00EC*/ 0x0F, (byte)0x8A, 0x0E, (byte)0xFF, (byte)0xFF, (byte)0xFF,// jp near ptr 0000000000008000h
			/*00F2*/ (byte)0xB0, 0x0A,// mov al,0Ah
			/*00F4*/ 0x0F, (byte)0x8B, 0x06, (byte)0xFF, (byte)0xFF, (byte)0xFF,// jnp near ptr 0000000000008000h
			/*00FA*/ (byte)0xB0, 0x0B,// mov al,0Bh
			/*00FC*/ 0x0F, (byte)0x8C, (byte)0xFE, (byte)0xFE, (byte)0xFF, (byte)0xFF,// jl near ptr 0000000000008000h
			/*0102*/ (byte)0xB0, 0x0C,// mov al,0Ch
			/*0104*/ 0x0F, (byte)0x8D, (byte)0xF6, (byte)0xFE, (byte)0xFF, (byte)0xFF,// jge near ptr 0000000000008000h
			/*010A*/ (byte)0xB0, 0x0D,// mov al,0Dh
			/*010C*/ 0x0F, (byte)0x8E, (byte)0xEE, (byte)0xFE, (byte)0xFF, (byte)0xFF,// jle near ptr 0000000000008000h
			/*0112*/ (byte)0xB0, 0x0E,// mov al,0Eh
			/*0114*/ 0x0F, (byte)0x8F, (byte)0xE6, (byte)0xFE, (byte)0xFF, (byte)0xFF,// jg near ptr 0000000000008000h
			/*011A*/ (byte)0xB0, 0x0F,// mov al,0Fh
		};
		byte[] newData = new byte[] {
			/*0000*/ 0x64, 0x67, (byte)0xC7, (byte)0x84, 0x0B, 0x78, 0x56, 0x34, 0x12, 0x78, 0x56, 0x34, 0x12,// mov dword ptr fs:[ebx+ecx+12345678h],12345678h
			/*000D*/ 0x64, 0x67, (byte)0xC7, (byte)0x84, 0x0B, 0x78, 0x56, 0x34, 0x12, 0x78, 0x56, 0x34, 0x12,// mov dword ptr fs:[ebx+ecx+12345678h],12345678h
			/*001A*/ 0x64, 0x67, (byte)0xC7, (byte)0x84, 0x0B, 0x78, 0x56, 0x34, 0x12, 0x78, 0x56, 0x34, 0x12,// mov dword ptr fs:[ebx+ecx+12345678h],12345678h
			/*0027*/ 0x64, 0x67, (byte)0xC7, (byte)0x84, 0x0B, 0x78, 0x56, 0x34, 0x12, 0x78, 0x56, 0x34, 0x12,// mov dword ptr fs:[ebx+ecx+12345678h],12345678h
			/*0034*/ 0x64, 0x67, (byte)0xC7, (byte)0x84, 0x0B, 0x78, 0x56, 0x34, 0x12, 0x78, 0x56, 0x34, 0x12,// mov dword ptr fs:[ebx+ecx+12345678h],12345678h
			/*0041*/ 0x64, 0x67, (byte)0xC7, (byte)0x84, 0x0B, 0x78, 0x56, 0x34, 0x12, 0x78, 0x56, 0x34, 0x12,// mov dword ptr fs:[ebx+ecx+12345678h],12345678h
			/*004E*/ 0x64, 0x67, (byte)0xC7, (byte)0x84, 0x0B, 0x78, 0x56, 0x34, 0x12, 0x78, 0x56, 0x34, 0x12,// mov dword ptr fs:[ebx+ecx+12345678h],12345678h
			/*005B*/ 0x64, 0x67, (byte)0xC7, (byte)0x84, 0x0B, 0x78, 0x56, 0x34, 0x12, 0x78, 0x56, 0x34, 0x12,// mov dword ptr fs:[ebx+ecx+12345678h],12345678h
			/*0068*/ 0x64, 0x67, (byte)0xC7, (byte)0x84, 0x0B, 0x78, 0x56, 0x34, 0x12, 0x78, 0x56, 0x34, 0x12,// mov dword ptr fs:[ebx+ecx+12345678h],12345678h
			/*0075*/ 0x64, 0x67, (byte)0xC7, (byte)0x84, 0x0B, 0x78, 0x56, 0x34, 0x12, 0x78, 0x56, 0x34, 0x12,// mov dword ptr fs:[ebx+ecx+12345678h],12345678h
			/*0082*/ 0x64, 0x67, (byte)0xC7, (byte)0x84, 0x0B, 0x78, 0x56, 0x34, 0x12, 0x78, 0x56, 0x34, 0x12,// mov dword ptr fs:[ebx+ecx+12345678h],12345678h
			/*008F*/ 0x64, 0x67, (byte)0xC7, (byte)0x84, 0x0B, 0x78, 0x56, 0x34, 0x12, 0x78, 0x56, 0x34, 0x12,// mov dword ptr fs:[ebx+ecx+12345678h],12345678h
			/*009C*/ 0x0F, (byte)0x80, 0x5E, (byte)0xFF, (byte)0xFF, (byte)0xFF,// jo near ptr 8000000000000000h
			/*00A2*/ (byte)0xB0, 0x00,// mov al,0
			/*00A4*/ 0x0F, (byte)0x81, 0x56, (byte)0xFF, (byte)0xFF, (byte)0xFF,// jno near ptr 8000000000000000h
			/*00AA*/ (byte)0xB0, 0x01,// mov al,1
			/*00AC*/ 0x0F, (byte)0x82, 0x4E, (byte)0xFF, (byte)0xFF, (byte)0xFF,// jb near ptr 8000000000000000h
			/*00B2*/ (byte)0xB0, 0x02,// mov al,2
			/*00B4*/ 0x0F, (byte)0x83, 0x46, (byte)0xFF, (byte)0xFF, (byte)0xFF,// jae near ptr 8000000000000000h
			/*00BA*/ (byte)0xB0, 0x03,// mov al,3
			/*00BC*/ 0x0F, (byte)0x84, 0x3E, (byte)0xFF, (byte)0xFF, (byte)0xFF,// je near ptr 8000000000000000h
			/*00C2*/ (byte)0xB0, 0x04,// mov al,4
			/*00C4*/ 0x0F, (byte)0x85, 0x36, (byte)0xFF, (byte)0xFF, (byte)0xFF,// jne near ptr 8000000000000000h
			/*00CA*/ (byte)0xB0, 0x05,// mov al,5
			/*00CC*/ 0x0F, (byte)0x86, 0x2E, (byte)0xFF, (byte)0xFF, (byte)0xFF,// jbe near ptr 8000000000000000h
			/*00D2*/ (byte)0xB0, 0x06,// mov al,6
			/*00D4*/ 0x0F, (byte)0x87, 0x26, (byte)0xFF, (byte)0xFF, (byte)0xFF,// ja near ptr 8000000000000000h
			/*00DA*/ (byte)0xB0, 0x07,// mov al,7
			/*00DC*/ 0x0F, (byte)0x88, 0x1E, (byte)0xFF, (byte)0xFF, (byte)0xFF,// js near ptr 8000000000000000h
			/*00E2*/ (byte)0xB0, 0x08,// mov al,8
			/*00E4*/ 0x0F, (byte)0x89, 0x16, (byte)0xFF, (byte)0xFF, (byte)0xFF,// jns near ptr 8000000000000000h
			/*00EA*/ (byte)0xB0, 0x09,// mov al,9
			/*00EC*/ 0x0F, (byte)0x8A, 0x0E, (byte)0xFF, (byte)0xFF, (byte)0xFF,// jp near ptr 8000000000000000h
			/*00F2*/ (byte)0xB0, 0x0A,// mov al,0Ah
			/*00F4*/ 0x0F, (byte)0x8B, 0x06, (byte)0xFF, (byte)0xFF, (byte)0xFF,// jnp near ptr 8000000000000000h
			/*00FA*/ (byte)0xB0, 0x0B,// mov al,0Bh
			/*00FC*/ 0x0F, (byte)0x8C, (byte)0xFE, (byte)0xFE, (byte)0xFF, (byte)0xFF,// jl near ptr 8000000000000000h
			/*0102*/ (byte)0xB0, 0x0C,// mov al,0Ch
			/*0104*/ 0x0F, (byte)0x8D, (byte)0xF6, (byte)0xFE, (byte)0xFF, (byte)0xFF,// jge near ptr 8000000000000000h
			/*010A*/ (byte)0xB0, 0x0D,// mov al,0Dh
			/*010C*/ 0x0F, (byte)0x8E, (byte)0xEE, (byte)0xFE, (byte)0xFF, (byte)0xFF,// jle near ptr 8000000000000000h
			/*0112*/ (byte)0xB0, 0x0E,// mov al,0Eh
			/*0114*/ 0x0F, (byte)0x8F, (byte)0xE6, (byte)0xFE, (byte)0xFF, (byte)0xFF,// jg near ptr 8000000000000000h
			/*011A*/ (byte)0xB0, 0x0F,// mov al,0Fh
		};
		int[] expectedInstructionOffsets = new int[] {
			0x0000,
			0x000D,
			0x001A,
			0x0027,
			0x0034,
			0x0041,
			0x004E,
			0x005B,
			0x0068,
			0x0075,
			0x0082,
			0x008F,
			0x009C,
			0x00A2,
			0x00A4,
			0x00AA,
			0x00AC,
			0x00B2,
			0x00B4,
			0x00BA,
			0x00BC,
			0x00C2,
			0x00C4,
			0x00CA,
			0x00CC,
			0x00D2,
			0x00D4,
			0x00DA,
			0x00DC,
			0x00E2,
			0x00E4,
			0x00EA,
			0x00EC,
			0x00F2,
			0x00F4,
			0x00FA,
			0x00FC,
			0x0102,
			0x0104,
			0x010A,
			0x010C,
			0x0112,
			0x0114,
			0x011A,
		};
		RelocInfo[] expectedRelocInfos = new RelocInfo[0];
		final int options = BlockEncoderOptions.NONE;
		encodeBase(bitness, origRip, originalData, newRip, newData, options, DECODER_OPTIONS, expectedInstructionOffsets, expectedRelocInfos);
	}

	@Test
	void jcc_near_other_short() {
		byte[] originalData = new byte[] {
			/*0000*/ 0x0F, (byte)0x80, 0x7A, 0x00, 0x00, 0x00,// jo near ptr 0000000000008080h
			/*0006*/ (byte)0xB0, 0x00,// mov al,0
			/*0008*/ 0x0F, (byte)0x81, 0x73, 0x00, 0x00, 0x00,// jno near ptr 0000000000008081h
			/*000E*/ (byte)0xB0, 0x01,// mov al,1
			/*0010*/ 0x0F, (byte)0x82, 0x6C, 0x00, 0x00, 0x00,// jb near ptr 0000000000008082h
			/*0016*/ (byte)0xB0, 0x02,// mov al,2
			/*0018*/ 0x0F, (byte)0x83, 0x65, 0x00, 0x00, 0x00,// jae near ptr 0000000000008083h
			/*001E*/ (byte)0xB0, 0x03,// mov al,3
			/*0020*/ 0x0F, (byte)0x84, 0x5E, 0x00, 0x00, 0x00,// je near ptr 0000000000008084h
			/*0026*/ (byte)0xB0, 0x04,// mov al,4
			/*0028*/ 0x0F, (byte)0x85, 0x57, 0x00, 0x00, 0x00,// jne near ptr 0000000000008085h
			/*002E*/ (byte)0xB0, 0x05,// mov al,5
			/*0030*/ 0x0F, (byte)0x86, 0x50, 0x00, 0x00, 0x00,// jbe near ptr 0000000000008086h
			/*0036*/ (byte)0xB0, 0x06,// mov al,6
			/*0038*/ 0x0F, (byte)0x87, 0x49, 0x00, 0x00, 0x00,// ja near ptr 0000000000008087h
			/*003E*/ (byte)0xB0, 0x07,// mov al,7
			/*0040*/ 0x0F, (byte)0x88, 0x42, 0x00, 0x00, 0x00,// js near ptr 0000000000008088h
			/*0046*/ (byte)0xB0, 0x08,// mov al,8
			/*0048*/ 0x0F, (byte)0x89, 0x3B, 0x00, 0x00, 0x00,// jns near ptr 0000000000008089h
			/*004E*/ (byte)0xB0, 0x09,// mov al,9
			/*0050*/ 0x0F, (byte)0x8A, 0x34, 0x00, 0x00, 0x00,// jp near ptr 000000000000808Ah
			/*0056*/ (byte)0xB0, 0x0A,// mov al,0Ah
			/*0058*/ 0x0F, (byte)0x8B, 0x2D, 0x00, 0x00, 0x00,// jnp near ptr 000000000000808Bh
			/*005E*/ (byte)0xB0, 0x0B,// mov al,0Bh
			/*0060*/ 0x0F, (byte)0x8C, 0x26, 0x00, 0x00, 0x00,// jl near ptr 000000000000808Ch
			/*0066*/ (byte)0xB0, 0x0C,// mov al,0Ch
			/*0068*/ 0x0F, (byte)0x8D, 0x1F, 0x00, 0x00, 0x00,// jge near ptr 000000000000808Dh
			/*006E*/ (byte)0xB0, 0x0D,// mov al,0Dh
			/*0070*/ 0x0F, (byte)0x8E, 0x18, 0x00, 0x00, 0x00,// jle near ptr 000000000000808Eh
			/*0076*/ (byte)0xB0, 0x0E,// mov al,0Eh
			/*0078*/ 0x0F, (byte)0x8F, 0x11, 0x00, 0x00, 0x00,// jg near ptr 000000000000808Fh
			/*007E*/ (byte)0xB0, 0x0F,// mov al,0Fh
		};
		byte[] newData = new byte[] {
			/*0000*/ 0x70, 0x7F,// jo short 0000000000008080h
			/*0002*/ (byte)0xB0, 0x00,// mov al,0
			/*0004*/ 0x71, 0x7C,// jno short 0000000000008081h
			/*0006*/ (byte)0xB0, 0x01,// mov al,1
			/*0008*/ 0x72, 0x79,// jb short 0000000000008082h
			/*000A*/ (byte)0xB0, 0x02,// mov al,2
			/*000C*/ 0x73, 0x76,// jae short 0000000000008083h
			/*000E*/ (byte)0xB0, 0x03,// mov al,3
			/*0010*/ 0x74, 0x73,// je short 0000000000008084h
			/*0012*/ (byte)0xB0, 0x04,// mov al,4
			/*0014*/ 0x75, 0x70,// jne short 0000000000008085h
			/*0016*/ (byte)0xB0, 0x05,// mov al,5
			/*0018*/ 0x76, 0x6D,// jbe short 0000000000008086h
			/*001A*/ (byte)0xB0, 0x06,// mov al,6
			/*001C*/ 0x77, 0x6A,// ja short 0000000000008087h
			/*001E*/ (byte)0xB0, 0x07,// mov al,7
			/*0020*/ 0x78, 0x67,// js short 0000000000008088h
			/*0022*/ (byte)0xB0, 0x08,// mov al,8
			/*0024*/ 0x79, 0x64,// jns short 0000000000008089h
			/*0026*/ (byte)0xB0, 0x09,// mov al,9
			/*0028*/ 0x7A, 0x61,// jp short 000000000000808Ah
			/*002A*/ (byte)0xB0, 0x0A,// mov al,0Ah
			/*002C*/ 0x7B, 0x5E,// jnp short 000000000000808Bh
			/*002E*/ (byte)0xB0, 0x0B,// mov al,0Bh
			/*0030*/ 0x7C, 0x5B,// jl short 000000000000808Ch
			/*0032*/ (byte)0xB0, 0x0C,// mov al,0Ch
			/*0034*/ 0x7D, 0x58,// jge short 000000000000808Dh
			/*0036*/ (byte)0xB0, 0x0D,// mov al,0Dh
			/*0038*/ 0x7E, 0x55,// jle short 000000000000808Eh
			/*003A*/ (byte)0xB0, 0x0E,// mov al,0Eh
			/*003C*/ 0x7F, 0x52,// jg short 000000000000808Fh
			/*003E*/ (byte)0xB0, 0x0F,// mov al,0Fh
		};
		int[] expectedInstructionOffsets = new int[] {
			0x0000,
			0x0002,
			0x0004,
			0x0006,
			0x0008,
			0x000A,
			0x000C,
			0x000E,
			0x0010,
			0x0012,
			0x0014,
			0x0016,
			0x0018,
			0x001A,
			0x001C,
			0x001E,
			0x0020,
			0x0022,
			0x0024,
			0x0026,
			0x0028,
			0x002A,
			0x002C,
			0x002E,
			0x0030,
			0x0032,
			0x0034,
			0x0036,
			0x0038,
			0x003A,
			0x003C,
			0x003E,
		};
		RelocInfo[] expectedRelocInfos = new RelocInfo[0];
		final int options = BlockEncoderOptions.NONE;
		encodeBase(bitness, origRip, originalData, origRip - 1, newData, options, DECODER_OPTIONS, expectedInstructionOffsets, expectedRelocInfos);
	}

	@Test
	void jcc_near_other_near() {
		byte[] originalData = new byte[] {
			/*0000*/ 0x0F, (byte)0x80, 0x7A, 0x00, 0x00, 0x00,// jo near ptr 0000000000008080h
			/*0006*/ (byte)0xB0, 0x00,// mov al,0
			/*0008*/ 0x0F, (byte)0x81, 0x73, 0x00, 0x00, 0x00,// jno near ptr 0000000000008081h
			/*000E*/ (byte)0xB0, 0x01,// mov al,1
			/*0010*/ 0x0F, (byte)0x82, 0x6C, 0x00, 0x00, 0x00,// jb near ptr 0000000000008082h
			/*0016*/ (byte)0xB0, 0x02,// mov al,2
			/*0018*/ 0x0F, (byte)0x83, 0x65, 0x00, 0x00, 0x00,// jae near ptr 0000000000008083h
			/*001E*/ (byte)0xB0, 0x03,// mov al,3
			/*0020*/ 0x0F, (byte)0x84, 0x5E, 0x00, 0x00, 0x00,// je near ptr 0000000000008084h
			/*0026*/ (byte)0xB0, 0x04,// mov al,4
			/*0028*/ 0x0F, (byte)0x85, 0x57, 0x00, 0x00, 0x00,// jne near ptr 0000000000008085h
			/*002E*/ (byte)0xB0, 0x05,// mov al,5
			/*0030*/ 0x0F, (byte)0x86, 0x50, 0x00, 0x00, 0x00,// jbe near ptr 0000000000008086h
			/*0036*/ (byte)0xB0, 0x06,// mov al,6
			/*0038*/ 0x0F, (byte)0x87, 0x49, 0x00, 0x00, 0x00,// ja near ptr 0000000000008087h
			/*003E*/ (byte)0xB0, 0x07,// mov al,7
			/*0040*/ 0x0F, (byte)0x88, 0x42, 0x00, 0x00, 0x00,// js near ptr 0000000000008088h
			/*0046*/ (byte)0xB0, 0x08,// mov al,8
			/*0048*/ 0x0F, (byte)0x89, 0x3B, 0x00, 0x00, 0x00,// jns near ptr 0000000000008089h
			/*004E*/ (byte)0xB0, 0x09,// mov al,9
			/*0050*/ 0x0F, (byte)0x8A, 0x34, 0x00, 0x00, 0x00,// jp near ptr 000000000000808Ah
			/*0056*/ (byte)0xB0, 0x0A,// mov al,0Ah
			/*0058*/ 0x0F, (byte)0x8B, 0x2D, 0x00, 0x00, 0x00,// jnp near ptr 000000000000808Bh
			/*005E*/ (byte)0xB0, 0x0B,// mov al,0Bh
			/*0060*/ 0x0F, (byte)0x8C, 0x26, 0x00, 0x00, 0x00,// jl near ptr 000000000000808Ch
			/*0066*/ (byte)0xB0, 0x0C,// mov al,0Ch
			/*0068*/ 0x0F, (byte)0x8D, 0x1F, 0x00, 0x00, 0x00,// jge near ptr 000000000000808Dh
			/*006E*/ (byte)0xB0, 0x0D,// mov al,0Dh
			/*0070*/ 0x0F, (byte)0x8E, 0x18, 0x00, 0x00, 0x00,// jle near ptr 000000000000808Eh
			/*0076*/ (byte)0xB0, 0x0E,// mov al,0Eh
			/*0078*/ 0x0F, (byte)0x8F, 0x11, 0x00, 0x00, 0x00,// jg near ptr 000000000000808Fh
			/*007E*/ (byte)0xB0, 0x0F,// mov al,0Fh
		};
		byte[] newData = new byte[] {
			/*0000*/ 0x0F, (byte)0x80, 0x7A, (byte)0xF0, (byte)0xFF, (byte)0xFF,// jo near ptr 0000000000008080h
			/*0006*/ (byte)0xB0, 0x00,// mov al,0
			/*0008*/ 0x0F, (byte)0x81, 0x73, (byte)0xF0, (byte)0xFF, (byte)0xFF,// jno near ptr 0000000000008081h
			/*000E*/ (byte)0xB0, 0x01,// mov al,1
			/*0010*/ 0x0F, (byte)0x82, 0x6C, (byte)0xF0, (byte)0xFF, (byte)0xFF,// jb near ptr 0000000000008082h
			/*0016*/ (byte)0xB0, 0x02,// mov al,2
			/*0018*/ 0x0F, (byte)0x83, 0x65, (byte)0xF0, (byte)0xFF, (byte)0xFF,// jae near ptr 0000000000008083h
			/*001E*/ (byte)0xB0, 0x03,// mov al,3
			/*0020*/ 0x0F, (byte)0x84, 0x5E, (byte)0xF0, (byte)0xFF, (byte)0xFF,// je near ptr 0000000000008084h
			/*0026*/ (byte)0xB0, 0x04,// mov al,4
			/*0028*/ 0x0F, (byte)0x85, 0x57, (byte)0xF0, (byte)0xFF, (byte)0xFF,// jne near ptr 0000000000008085h
			/*002E*/ (byte)0xB0, 0x05,// mov al,5
			/*0030*/ 0x0F, (byte)0x86, 0x50, (byte)0xF0, (byte)0xFF, (byte)0xFF,// jbe near ptr 0000000000008086h
			/*0036*/ (byte)0xB0, 0x06,// mov al,6
			/*0038*/ 0x0F, (byte)0x87, 0x49, (byte)0xF0, (byte)0xFF, (byte)0xFF,// ja near ptr 0000000000008087h
			/*003E*/ (byte)0xB0, 0x07,// mov al,7
			/*0040*/ 0x0F, (byte)0x88, 0x42, (byte)0xF0, (byte)0xFF, (byte)0xFF,// js near ptr 0000000000008088h
			/*0046*/ (byte)0xB0, 0x08,// mov al,8
			/*0048*/ 0x0F, (byte)0x89, 0x3B, (byte)0xF0, (byte)0xFF, (byte)0xFF,// jns near ptr 0000000000008089h
			/*004E*/ (byte)0xB0, 0x09,// mov al,9
			/*0050*/ 0x0F, (byte)0x8A, 0x34, (byte)0xF0, (byte)0xFF, (byte)0xFF,// jp near ptr 000000000000808Ah
			/*0056*/ (byte)0xB0, 0x0A,// mov al,0Ah
			/*0058*/ 0x0F, (byte)0x8B, 0x2D, (byte)0xF0, (byte)0xFF, (byte)0xFF,// jnp near ptr 000000000000808Bh
			/*005E*/ (byte)0xB0, 0x0B,// mov al,0Bh
			/*0060*/ 0x0F, (byte)0x8C, 0x26, (byte)0xF0, (byte)0xFF, (byte)0xFF,// jl near ptr 000000000000808Ch
			/*0066*/ (byte)0xB0, 0x0C,// mov al,0Ch
			/*0068*/ 0x0F, (byte)0x8D, 0x1F, (byte)0xF0, (byte)0xFF, (byte)0xFF,// jge near ptr 000000000000808Dh
			/*006E*/ (byte)0xB0, 0x0D,// mov al,0Dh
			/*0070*/ 0x0F, (byte)0x8E, 0x18, (byte)0xF0, (byte)0xFF, (byte)0xFF,// jle near ptr 000000000000808Eh
			/*0076*/ (byte)0xB0, 0x0E,// mov al,0Eh
			/*0078*/ 0x0F, (byte)0x8F, 0x11, (byte)0xF0, (byte)0xFF, (byte)0xFF,// jg near ptr 000000000000808Fh
			/*007E*/ (byte)0xB0, 0x0F,// mov al,0Fh
		};
		int[] expectedInstructionOffsets = new int[] {
			0x0000,
			0x0006,
			0x0008,
			0x000E,
			0x0010,
			0x0016,
			0x0018,
			0x001E,
			0x0020,
			0x0026,
			0x0028,
			0x002E,
			0x0030,
			0x0036,
			0x0038,
			0x003E,
			0x0040,
			0x0046,
			0x0048,
			0x004E,
			0x0050,
			0x0056,
			0x0058,
			0x005E,
			0x0060,
			0x0066,
			0x0068,
			0x006E,
			0x0070,
			0x0076,
			0x0078,
			0x007E,
		};
		RelocInfo[] expectedRelocInfos = new RelocInfo[0];
		final int options = BlockEncoderOptions.NONE;
		encodeBase(bitness, origRip, originalData, origRip + 0x1000, newData, options, DECODER_OPTIONS, expectedInstructionOffsets, expectedRelocInfos);
	}

	@Test
	void jcc_near_other_long() {
		byte[] originalData = new byte[] {
			/*0000*/ 0x0F, (byte)0x80, 0x7B, 0x00, 0x00, 0x00,// jo near ptr 123456789ABCDE81h
			/*0006*/ (byte)0xB0, 0x00,// mov al,0
			/*0008*/ 0x0F, (byte)0x81, 0x74, 0x00, 0x00, 0x00,// jno near ptr 123456789ABCDE82h
			/*000E*/ (byte)0xB0, 0x01,// mov al,1
			/*0010*/ 0x0F, (byte)0x82, 0x6D, 0x00, 0x00, 0x00,// jb near ptr 123456789ABCDE83h
			/*0016*/ (byte)0xB0, 0x02,// mov al,2
			/*0018*/ 0x0F, (byte)0x83, 0x66, 0x00, 0x00, 0x00,// jae near ptr 123456789ABCDE84h
			/*001E*/ (byte)0xB0, 0x03,// mov al,3
			/*0020*/ 0x0F, (byte)0x84, 0x5F, 0x00, 0x00, 0x00,// je near ptr 123456789ABCDE85h
			/*0026*/ (byte)0xB0, 0x04,// mov al,4
			/*0028*/ 0x0F, (byte)0x85, 0x58, 0x00, 0x00, 0x00,// jne near ptr 123456789ABCDE86h
			/*002E*/ (byte)0xB0, 0x05,// mov al,5
			/*0030*/ 0x0F, (byte)0x86, 0x51, 0x00, 0x00, 0x00,// jbe near ptr 123456789ABCDE87h
			/*0036*/ (byte)0xB0, 0x06,// mov al,6
			/*0038*/ 0x0F, (byte)0x87, 0x4A, 0x00, 0x00, 0x00,// ja near ptr 123456789ABCDE88h
			/*003E*/ (byte)0xB0, 0x07,// mov al,7
			/*0040*/ 0x0F, (byte)0x88, 0x43, 0x00, 0x00, 0x00,// js near ptr 123456789ABCDE89h
			/*0046*/ (byte)0xB0, 0x08,// mov al,8
			/*0048*/ 0x0F, (byte)0x89, 0x3C, 0x00, 0x00, 0x00,// jns near ptr 123456789ABCDE8Ah
			/*004E*/ (byte)0xB0, 0x09,// mov al,9
			/*0050*/ 0x0F, (byte)0x8A, 0x35, 0x00, 0x00, 0x00,// jp near ptr 123456789ABCDE8Bh
			/*0056*/ (byte)0xB0, 0x0A,// mov al,0Ah
			/*0058*/ 0x0F, (byte)0x8B, 0x2E, 0x00, 0x00, 0x00,// jnp near ptr 123456789ABCDE8Ch
			/*005E*/ (byte)0xB0, 0x0B,// mov al,0Bh
			/*0060*/ 0x0F, (byte)0x8C, 0x27, 0x00, 0x00, 0x00,// jl near ptr 123456789ABCDE8Dh
			/*0066*/ (byte)0xB0, 0x0C,// mov al,0Ch
			/*0068*/ 0x0F, (byte)0x8D, 0x20, 0x00, 0x00, 0x00,// jge near ptr 123456789ABCDE8Eh
			/*006E*/ (byte)0xB0, 0x0D,// mov al,0Dh
			/*0070*/ 0x0F, (byte)0x8E, 0x19, 0x00, 0x00, 0x00,// jle near ptr 123456789ABCDE8Fh
			/*0076*/ (byte)0xB0, 0x0E,// mov al,0Eh
			/*0078*/ 0x0F, (byte)0x8F, 0x12, 0x00, 0x00, 0x00,// jg near ptr 123456789ABCDE90h
			/*007E*/ (byte)0xB0, 0x0F,// mov al,0Fh
			/*0080*/ (byte)0x90,// nop
		};
		byte[] newData = new byte[] {
			/*0000*/ 0x71, 0x06,// jno short 8000000000000008h
			/*0002*/ (byte)0xFF, 0x25, (byte)0xA0, 0x00, 0x00, 0x00,// jmp qword ptr [80000000000000A8h]
			/*0008*/ (byte)0xB0, 0x00,// mov al,0
			/*000A*/ 0x70, 0x06,// jo short 8000000000000012h
			/*000C*/ (byte)0xFF, 0x25, (byte)0x9E, 0x00, 0x00, 0x00,// jmp qword ptr [80000000000000B0h]
			/*0012*/ (byte)0xB0, 0x01,// mov al,1
			/*0014*/ 0x73, 0x06,// jae short 800000000000001Ch
			/*0016*/ (byte)0xFF, 0x25, (byte)0x9C, 0x00, 0x00, 0x00,// jmp qword ptr [80000000000000B8h]
			/*001C*/ (byte)0xB0, 0x02,// mov al,2
			/*001E*/ 0x72, 0x06,// jb short 8000000000000026h
			/*0020*/ (byte)0xFF, 0x25, (byte)0x9A, 0x00, 0x00, 0x00,// jmp qword ptr [80000000000000C0h]
			/*0026*/ (byte)0xB0, 0x03,// mov al,3
			/*0028*/ 0x75, 0x06,// jne short 8000000000000030h
			/*002A*/ (byte)0xFF, 0x25, (byte)0x98, 0x00, 0x00, 0x00,// jmp qword ptr [80000000000000C8h]
			/*0030*/ (byte)0xB0, 0x04,// mov al,4
			/*0032*/ 0x74, 0x06,// je short 800000000000003Ah
			/*0034*/ (byte)0xFF, 0x25, (byte)0x96, 0x00, 0x00, 0x00,// jmp qword ptr [80000000000000D0h]
			/*003A*/ (byte)0xB0, 0x05,// mov al,5
			/*003C*/ 0x77, 0x06,// ja short 8000000000000044h
			/*003E*/ (byte)0xFF, 0x25, (byte)0x94, 0x00, 0x00, 0x00,// jmp qword ptr [80000000000000D8h]
			/*0044*/ (byte)0xB0, 0x06,// mov al,6
			/*0046*/ 0x76, 0x06,// jbe short 800000000000004Eh
			/*0048*/ (byte)0xFF, 0x25, (byte)0x92, 0x00, 0x00, 0x00,// jmp qword ptr [80000000000000E0h]
			/*004E*/ (byte)0xB0, 0x07,// mov al,7
			/*0050*/ 0x79, 0x06,// jns short 8000000000000058h
			/*0052*/ (byte)0xFF, 0x25, (byte)0x90, 0x00, 0x00, 0x00,// jmp qword ptr [80000000000000E8h]
			/*0058*/ (byte)0xB0, 0x08,// mov al,8
			/*005A*/ 0x78, 0x06,// js short 8000000000000062h
			/*005C*/ (byte)0xFF, 0x25, (byte)0x8E, 0x00, 0x00, 0x00,// jmp qword ptr [80000000000000F0h]
			/*0062*/ (byte)0xB0, 0x09,// mov al,9
			/*0064*/ 0x7B, 0x06,// jnp short 800000000000006Ch
			/*0066*/ (byte)0xFF, 0x25, (byte)0x8C, 0x00, 0x00, 0x00,// jmp qword ptr [80000000000000F8h]
			/*006C*/ (byte)0xB0, 0x0A,// mov al,0Ah
			/*006E*/ 0x7A, 0x06,// jp short 8000000000000076h
			/*0070*/ (byte)0xFF, 0x25, (byte)0x8A, 0x00, 0x00, 0x00,// jmp qword ptr [8000000000000100h]
			/*0076*/ (byte)0xB0, 0x0B,// mov al,0Bh
			/*0078*/ 0x7D, 0x06,// jge short 8000000000000080h
			/*007A*/ (byte)0xFF, 0x25, (byte)0x88, 0x00, 0x00, 0x00,// jmp qword ptr [8000000000000108h]
			/*0080*/ (byte)0xB0, 0x0C,// mov al,0Ch
			/*0082*/ 0x7C, 0x06,// jl short 800000000000008Ah
			/*0084*/ (byte)0xFF, 0x25, (byte)0x86, 0x00, 0x00, 0x00,// jmp qword ptr [8000000000000110h]
			/*008A*/ (byte)0xB0, 0x0D,// mov al,0Dh
			/*008C*/ 0x7F, 0x06,// jg short 8000000000000094h
			/*008E*/ (byte)0xFF, 0x25, (byte)0x84, 0x00, 0x00, 0x00,// jmp qword ptr [8000000000000118h]
			/*0094*/ (byte)0xB0, 0x0E,// mov al,0Eh
			/*0096*/ 0x7E, 0x06,// jle short 800000000000009Eh
			/*0098*/ (byte)0xFF, 0x25, (byte)0x82, 0x00, 0x00, 0x00,// jmp qword ptr [8000000000000120h]
			/*009E*/ (byte)0xB0, 0x0F,// mov al,0Fh
			/*00A0*/ (byte)0x90,// nop
			/*00A1*/ (byte)0xCC, (byte)0xCC, (byte)0xCC, (byte)0xCC, (byte)0xCC, (byte)0xCC, (byte)0xCC,
			/*00A8*/ (byte)0x81, (byte)0xDE, (byte)0xBC, (byte)0x9A, 0x78, 0x56, 0x34, 0x12,
			/*00B0*/ (byte)0x82, (byte)0xDE, (byte)0xBC, (byte)0x9A, 0x78, 0x56, 0x34, 0x12,
			/*00B8*/ (byte)0x83, (byte)0xDE, (byte)0xBC, (byte)0x9A, 0x78, 0x56, 0x34, 0x12,
			/*00C0*/ (byte)0x84, (byte)0xDE, (byte)0xBC, (byte)0x9A, 0x78, 0x56, 0x34, 0x12,
			/*00C8*/ (byte)0x85, (byte)0xDE, (byte)0xBC, (byte)0x9A, 0x78, 0x56, 0x34, 0x12,
			/*00D0*/ (byte)0x86, (byte)0xDE, (byte)0xBC, (byte)0x9A, 0x78, 0x56, 0x34, 0x12,
			/*00D8*/ (byte)0x87, (byte)0xDE, (byte)0xBC, (byte)0x9A, 0x78, 0x56, 0x34, 0x12,
			/*00E0*/ (byte)0x88, (byte)0xDE, (byte)0xBC, (byte)0x9A, 0x78, 0x56, 0x34, 0x12,
			/*00E8*/ (byte)0x89, (byte)0xDE, (byte)0xBC, (byte)0x9A, 0x78, 0x56, 0x34, 0x12,
			/*00F0*/ (byte)0x8A, (byte)0xDE, (byte)0xBC, (byte)0x9A, 0x78, 0x56, 0x34, 0x12,
			/*00F8*/ (byte)0x8B, (byte)0xDE, (byte)0xBC, (byte)0x9A, 0x78, 0x56, 0x34, 0x12,
			/*0100*/ (byte)0x8C, (byte)0xDE, (byte)0xBC, (byte)0x9A, 0x78, 0x56, 0x34, 0x12,
			/*0108*/ (byte)0x8D, (byte)0xDE, (byte)0xBC, (byte)0x9A, 0x78, 0x56, 0x34, 0x12,
			/*0110*/ (byte)0x8E, (byte)0xDE, (byte)0xBC, (byte)0x9A, 0x78, 0x56, 0x34, 0x12,
			/*0118*/ (byte)0x8F, (byte)0xDE, (byte)0xBC, (byte)0x9A, 0x78, 0x56, 0x34, 0x12,
			/*0120*/ (byte)0x90, (byte)0xDE, (byte)0xBC, (byte)0x9A, 0x78, 0x56, 0x34, 0x12,
		};
		int[] expectedInstructionOffsets = new int[] {
			0xFFFF_FFFF,
			0x0008,
			0xFFFF_FFFF,
			0x0012,
			0xFFFF_FFFF,
			0x001C,
			0xFFFF_FFFF,
			0x0026,
			0xFFFF_FFFF,
			0x0030,
			0xFFFF_FFFF,
			0x003A,
			0xFFFF_FFFF,
			0x0044,
			0xFFFF_FFFF,
			0x004E,
			0xFFFF_FFFF,
			0x0058,
			0xFFFF_FFFF,
			0x0062,
			0xFFFF_FFFF,
			0x006C,
			0xFFFF_FFFF,
			0x0076,
			0xFFFF_FFFF,
			0x0080,
			0xFFFF_FFFF,
			0x008A,
			0xFFFF_FFFF,
			0x0094,
			0xFFFF_FFFF,
			0x009E,
			0x00A0,
		};
		RelocInfo[] expectedRelocInfos = new RelocInfo[] {
			new RelocInfo(RelocKind.OFFSET64, 0x80000000000000A8L),
			new RelocInfo(RelocKind.OFFSET64, 0x80000000000000B0L),
			new RelocInfo(RelocKind.OFFSET64, 0x80000000000000B8L),
			new RelocInfo(RelocKind.OFFSET64, 0x80000000000000C0L),
			new RelocInfo(RelocKind.OFFSET64, 0x80000000000000C8L),
			new RelocInfo(RelocKind.OFFSET64, 0x80000000000000D0L),
			new RelocInfo(RelocKind.OFFSET64, 0x80000000000000D8L),
			new RelocInfo(RelocKind.OFFSET64, 0x80000000000000E0L),
			new RelocInfo(RelocKind.OFFSET64, 0x80000000000000E8L),
			new RelocInfo(RelocKind.OFFSET64, 0x80000000000000F0L),
			new RelocInfo(RelocKind.OFFSET64, 0x80000000000000F8L),
			new RelocInfo(RelocKind.OFFSET64, 0x8000000000000100L),
			new RelocInfo(RelocKind.OFFSET64, 0x8000000000000108L),
			new RelocInfo(RelocKind.OFFSET64, 0x8000000000000110L),
			new RelocInfo(RelocKind.OFFSET64, 0x8000000000000118L),
			new RelocInfo(RelocKind.OFFSET64, 0x8000000000000120L),
		};
		final int options = BlockEncoderOptions.NONE;
		final long origRip = 0x123456789ABCDE00L;
		encodeBase(bitness, origRip, originalData, newRip, newData, options, DECODER_OPTIONS, expectedInstructionOffsets, expectedRelocInfos);
	}

	@Test
	void jcc_near_fwd_short_no_opt() {
		byte[] originalData = new byte[] {
			/*0000*/ 0x0F, (byte)0x80, 0x7A, 0x00, 0x00, 0x00,// jo near ptr 0000000000008080h
			/*0006*/ (byte)0xB0, 0x00,// mov al,0
			/*0008*/ 0x0F, (byte)0x81, 0x72, 0x00, 0x00, 0x00,// jno near ptr 0000000000008080h
			/*000E*/ (byte)0xB0, 0x01,// mov al,1
			/*0010*/ 0x0F, (byte)0x82, 0x6A, 0x00, 0x00, 0x00,// jb near ptr 0000000000008080h
			/*0016*/ (byte)0xB0, 0x02,// mov al,2
			/*0018*/ 0x0F, (byte)0x83, 0x62, 0x00, 0x00, 0x00,// jae near ptr 0000000000008080h
			/*001E*/ (byte)0xB0, 0x03,// mov al,3
			/*0020*/ 0x0F, (byte)0x84, 0x5A, 0x00, 0x00, 0x00,// je near ptr 0000000000008080h
			/*0026*/ (byte)0xB0, 0x04,// mov al,4
			/*0028*/ 0x0F, (byte)0x85, 0x52, 0x00, 0x00, 0x00,// jne near ptr 0000000000008080h
			/*002E*/ (byte)0xB0, 0x05,// mov al,5
			/*0030*/ 0x0F, (byte)0x86, 0x4A, 0x00, 0x00, 0x00,// jbe near ptr 0000000000008080h
			/*0036*/ (byte)0xB0, 0x06,// mov al,6
			/*0038*/ 0x0F, (byte)0x87, 0x42, 0x00, 0x00, 0x00,// ja near ptr 0000000000008080h
			/*003E*/ (byte)0xB0, 0x07,// mov al,7
			/*0040*/ 0x0F, (byte)0x88, 0x3A, 0x00, 0x00, 0x00,// js near ptr 0000000000008080h
			/*0046*/ (byte)0xB0, 0x08,// mov al,8
			/*0048*/ 0x0F, (byte)0x89, 0x32, 0x00, 0x00, 0x00,// jns near ptr 0000000000008080h
			/*004E*/ (byte)0xB0, 0x09,// mov al,9
			/*0050*/ 0x0F, (byte)0x8A, 0x2A, 0x00, 0x00, 0x00,// jp near ptr 0000000000008080h
			/*0056*/ (byte)0xB0, 0x0A,// mov al,0Ah
			/*0058*/ 0x0F, (byte)0x8B, 0x22, 0x00, 0x00, 0x00,// jnp near ptr 0000000000008080h
			/*005E*/ (byte)0xB0, 0x0B,// mov al,0Bh
			/*0060*/ 0x0F, (byte)0x8C, 0x1A, 0x00, 0x00, 0x00,// jl near ptr 0000000000008080h
			/*0066*/ (byte)0xB0, 0x0C,// mov al,0Ch
			/*0068*/ 0x0F, (byte)0x8D, 0x12, 0x00, 0x00, 0x00,// jge near ptr 0000000000008080h
			/*006E*/ (byte)0xB0, 0x0D,// mov al,0Dh
			/*0070*/ 0x0F, (byte)0x8E, 0x0A, 0x00, 0x00, 0x00,// jle near ptr 0000000000008080h
			/*0076*/ (byte)0xB0, 0x0E,// mov al,0Eh
			/*0078*/ 0x0F, (byte)0x8F, 0x02, 0x00, 0x00, 0x00,// jg near ptr 0000000000008080h
			/*007E*/ (byte)0xB0, 0x0F,// mov al,0Fh
			/*0080*/ (byte)0xB0, 0x10,// mov al,10h
		};
		byte[] newData = new byte[] {
			/*0000*/ 0x0F, (byte)0x80, 0x7A, 0x00, 0x00, 0x00,// jo near ptr 0000000000008080h
			/*0006*/ (byte)0xB0, 0x00,// mov al,0
			/*0008*/ 0x0F, (byte)0x81, 0x72, 0x00, 0x00, 0x00,// jno near ptr 0000000000008080h
			/*000E*/ (byte)0xB0, 0x01,// mov al,1
			/*0010*/ 0x0F, (byte)0x82, 0x6A, 0x00, 0x00, 0x00,// jb near ptr 0000000000008080h
			/*0016*/ (byte)0xB0, 0x02,// mov al,2
			/*0018*/ 0x0F, (byte)0x83, 0x62, 0x00, 0x00, 0x00,// jae near ptr 0000000000008080h
			/*001E*/ (byte)0xB0, 0x03,// mov al,3
			/*0020*/ 0x0F, (byte)0x84, 0x5A, 0x00, 0x00, 0x00,// je near ptr 0000000000008080h
			/*0026*/ (byte)0xB0, 0x04,// mov al,4
			/*0028*/ 0x0F, (byte)0x85, 0x52, 0x00, 0x00, 0x00,// jne near ptr 0000000000008080h
			/*002E*/ (byte)0xB0, 0x05,// mov al,5
			/*0030*/ 0x0F, (byte)0x86, 0x4A, 0x00, 0x00, 0x00,// jbe near ptr 0000000000008080h
			/*0036*/ (byte)0xB0, 0x06,// mov al,6
			/*0038*/ 0x0F, (byte)0x87, 0x42, 0x00, 0x00, 0x00,// ja near ptr 0000000000008080h
			/*003E*/ (byte)0xB0, 0x07,// mov al,7
			/*0040*/ 0x0F, (byte)0x88, 0x3A, 0x00, 0x00, 0x00,// js near ptr 0000000000008080h
			/*0046*/ (byte)0xB0, 0x08,// mov al,8
			/*0048*/ 0x0F, (byte)0x89, 0x32, 0x00, 0x00, 0x00,// jns near ptr 0000000000008080h
			/*004E*/ (byte)0xB0, 0x09,// mov al,9
			/*0050*/ 0x0F, (byte)0x8A, 0x2A, 0x00, 0x00, 0x00,// jp near ptr 0000000000008080h
			/*0056*/ (byte)0xB0, 0x0A,// mov al,0Ah
			/*0058*/ 0x0F, (byte)0x8B, 0x22, 0x00, 0x00, 0x00,// jnp near ptr 0000000000008080h
			/*005E*/ (byte)0xB0, 0x0B,// mov al,0Bh
			/*0060*/ 0x0F, (byte)0x8C, 0x1A, 0x00, 0x00, 0x00,// jl near ptr 0000000000008080h
			/*0066*/ (byte)0xB0, 0x0C,// mov al,0Ch
			/*0068*/ 0x0F, (byte)0x8D, 0x12, 0x00, 0x00, 0x00,// jge near ptr 0000000000008080h
			/*006E*/ (byte)0xB0, 0x0D,// mov al,0Dh
			/*0070*/ 0x0F, (byte)0x8E, 0x0A, 0x00, 0x00, 0x00,// jle near ptr 0000000000008080h
			/*0076*/ (byte)0xB0, 0x0E,// mov al,0Eh
			/*0078*/ 0x0F, (byte)0x8F, 0x02, 0x00, 0x00, 0x00,// jg near ptr 0000000000008080h
			/*007E*/ (byte)0xB0, 0x0F,// mov al,0Fh
			/*0080*/ (byte)0xB0, 0x10,// mov al,10h
		};
		int[] expectedInstructionOffsets = new int[] {
			0x0000,
			0x0006,
			0x0008,
			0x000E,
			0x0010,
			0x0016,
			0x0018,
			0x001E,
			0x0020,
			0x0026,
			0x0028,
			0x002E,
			0x0030,
			0x0036,
			0x0038,
			0x003E,
			0x0040,
			0x0046,
			0x0048,
			0x004E,
			0x0050,
			0x0056,
			0x0058,
			0x005E,
			0x0060,
			0x0066,
			0x0068,
			0x006E,
			0x0070,
			0x0076,
			0x0078,
			0x007E,
			0x0080,
		};
		RelocInfo[] expectedRelocInfos = new RelocInfo[0];
		final int options = BlockEncoderOptions.DONT_FIX_BRANCHES;
		encodeBase(bitness, origRip, originalData, newRip, newData, options, DECODER_OPTIONS, expectedInstructionOffsets, expectedRelocInfos);
	}
}
